diff --git a/bin/piece/install-devel-helper b/bin/piece/install-devel-helper
index cfe96f5..d92f804 100755
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/bin/piece/install-devel-helper
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/bin/piece/install-devel-helper
@@ -14,10 +14,10 @@ mv $DESTDIR$OO_INSTDIR/solver $DESTDIR$OO_INSTDIR_SHARE
 
 # file list for the devel stuff
 echo "%dir $OO_INSTDIR_SHARE" >files-$piece-devel.txt
-for dir in `find $DESTDIR$OO_INSTDIR_SHARE/solver -type d | sed "s|$DESTDIR||" | grep -v "$OO_INSTDIR_SHARE/solver/noarch"` ; do
+for dir in `find $DESTDIR$OO_INSTDIR_SHARE/solver -type d | sed "s|$DESTDIR||" | grep -v "$OO_INSTDIR_SHARE/solver/noarch"|sort` ; do
     echo "%dir $dir" >>files-$piece-devel.txt
 done
-find $DESTDIR$OO_INSTDIR_SHARE/solver -type f | sed "s|$DESTDIR||" | grep -v "$OO_INSTDIR_SHARE/solver/noarch" >>files-$piece-devel.txt
+find $DESTDIR$OO_INSTDIR_SHARE/solver -type f | sed "s|$DESTDIR||" | grep -v "$OO_INSTDIR_SHARE/solver/noarch"|sort >>files-$piece-devel.txt
 # install the list for link-to-ooo-home script if not empty; top dir is always mentioned
 if test `cat files-$piece-devel.txt | wc -l` -gt 1 ; then
     cp files-$piece-devel.txt $DESTDIR$OO_INSTDIR_SHARE/
@@ -26,10 +26,10 @@ fi
 
 # file list for the prebuilt stuff if any
 rm -f files-$piece-prebuilt.txt
-for dir in `find $DESTDIR$OO_INSTDIR_SHARE/solver -type d | sed "s|$DESTDIR||" | grep "$OO_INSTDIR_SHARE/solver/noarch"` ; do
+for dir in `find $DESTDIR$OO_INSTDIR_SHARE/solver -type d | sed "s|$DESTDIR||" | grep "$OO_INSTDIR_SHARE/solver/noarch"|sort` ; do
     echo "%dir $dir" >>files-$piece-prebuilt.txt
 done
-find $DESTDIR$OO_INSTDIR_SHARE/solver -type f | sed "s|$DESTDIR||" | grep "$OO_INSTDIR_SHARE/solver/noarch" >>files-$piece-prebuilt.txt
+find $DESTDIR$OO_INSTDIR_SHARE/solver -type f | sed "s|$DESTDIR||" | grep "$OO_INSTDIR_SHARE/solver/noarch"|sort >>files-$piece-prebuilt.txt
 # install the list for link-to-ooo-home script if not empty
 if test `cat files-$piece-prebuilt.txt | wc -l` -gt 1 ; then
     cp files-$piece-prebuilt.txt $DESTDIR$OO_INSTDIR_SHARE/
diff --git a/bin/piece/post-inst-postprocess b/bin/piece/post-inst-postprocess
index aa241b4..b132d29 100755
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/bin/piece/post-inst-postprocess
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/bin/piece/post-inst-postprocess
@@ -29,7 +29,7 @@ export JVMFWK_CONFIGFILE=file://`pwd`/jvmfwk3rc
 # FIXME: it would be possible to generate this file by the installer, e.g. in bootstrap
 if test "$DISTRO" = "SUSE" || echo "$DISTRO" | grep -q "SUSE-11" ; then
     if diff -q $DESTDIR$OO_INSTDIR/program/sofficerc $OO_INSTDIR_SHARE/ooo-build/src/sofficerc-upstream ; then
-	rm $DESTDIR$OO_INSTDIR/program/sofficerc
+	rm -f $DESTDIR$OO_INSTDIR/program/sofficerc
 	ln -sf $OO_INSTDIR_SHARE/program/sofficerc $DESTDIR$OO_INSTDIR/program/sofficerc
     else
 	echo "Error: The file \"sofficerc\" has changed in the sources"
diff --git a/configure.in b/configure.in
index de91cf7..3af840d 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/configure.in
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/configure.in
@@ -877,7 +877,7 @@ AC_SUBST(CAIRO_CONFIGURE_FLAG)
 PREBUILT_WRITINGAIDS_TIMESTAMP=20091204
 AC_SUBST(PREBUILT_WRITINGAIDS_TIMESTAMP)
 
-PREBUILT_EXTENSIONAIDS_TIMESTAMP=20100215
+PREBUILT_EXTENSIONAIDS_TIMESTAMP=20100518
 AC_SUBST(PREBUILT_EXTENSIONAIDS_TIMESTAMP)
 
 BUILD_MOZILLA_SOURCE='seamonkey-1.1.14.source.tar.gz'
@@ -1577,7 +1577,7 @@ elif test "$with_tag" = "OOO310_m18" ; then
    UPSTREAM_VERSION=3.1.1
 elif test "$with_tag" = "OOO320_m8" ; then
    UPSTREAM_VERSION=3.2.0
-elif test "$with_tag" = "OOO320_m17" ; then
+elif test "$with_tag" = "OOO320_m18" ; then
    UPSTREAM_VERSION=3.2.1
 fi
 if test -n "$UPSTREAM_VERSION"; then
@@ -1790,12 +1790,8 @@ To build run:
 $warn_use_download	make
 	bin/ooinstall <path-to-install>
 
-	This is 'master' - the main, but unstable branch.
-
-	If you want to build the stable OOo, use:
-		ooo-build-2-4    branch for 2.4
-		ooo-build-3-1-1  branch for 3.1.1
-		ooo-build-3-2    branch for 3.2
+	This is ooo-build-3-2-1 - the stable branch for the 3.2.1 release.
+	If you want to build something cool, unstable, and risky, use master.
 "
 
 if test "$BUILD_WIN32" != "yes" -a "$ENABLE_ICECREAM" != "yes"; then
diff --git a/desktop/draw.desktop.in.in b/desktop/draw.desktop.in.in
index fe264ee..c0be959 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/desktop/draw.desktop.in.in
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/desktop/draw.desktop.in.in
@@ -8,7 +8,7 @@ Type=Application
 Categories=Graphics;VectorGraphics;
 StartupNotify=false
 InitialPreference=6
-MimeType=application/vnd.oasis.opendocument.graphics;application/vnd.oasis.opendocument.graphics-template;application/vnd.stardivision.draw;application/vnd.sun.xml.draw;application/vnd.sun.xml.draw.template;
+MimeType=application/vnd.oasis.opendocument.graphics;application/vnd.oasis.opendocument.graphics-template;application/vnd.stardivision.draw;application/vnd.sun.xml.draw;application/vnd.sun.xml.draw.template;application/x-wpg;
 _Name=OpenOffice.org Draw
 _GenericName=Drawing
 _Comment=Create and edit drawings, flow charts, and logos by using Draw.
diff --git a/patches/dev300/apple-remote-update.diff b/patches/dev300/apple-remote-update.diff
deleted file mode 100644
index 8cb566f..0000000
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apple-remote-update.diff
+++ /dev/null
@@ -1,67 +0,0 @@
-diff -r 5c6b8c37653f apple_remote/AppleRemote.m
---- apple_remote/AppleRemote.m	Tue Dec 15 14:27:37 2009 +0100
-+++ apple_remote/AppleRemote.m	Tue Dec 15 19:18:56 2009 +0100
-@@ -43,6 +43,10 @@
- 	#define NSAppKitVersionNumber10_4 824
- #endif
- 
-+#ifndef NSAppKitVersionNumber10_5
-+    #define NSAppKitVersionNumber10_5 949
-+#endif
-+
- @implementation AppleRemote
- 
- + (const char*) remoteControlDeviceName {
-@@ -52,7 +56,12 @@
- - (void) setCookieMappingInDictionary: (NSMutableDictionary*) _cookieToButtonMapping	{	
-     
-     // TODO : avoid such magics 
--	if (floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_4) {
-+	if (floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_4) 
-+    {
-+        #ifdef DEBUG
-+            NSLog( @"setting 10.4 cookies" );
-+        #endif
-+
- 		// 10.4.x Tiger
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlus]		forKey:@"14_12_11_6_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMinus]		forKey:@"14_13_11_6_"];		
-@@ -65,7 +74,12 @@
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu_Hold]	forKey:@"14_6_14_6_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay_Hold]	forKey:@"18_14_6_18_14_6_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteControl_Switched]	forKey:@"19_"];			
--	} else {
-+	} 
-+    else if( floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_5 )
-+    {
-+        #ifdef DEBUG
-+            NSLog( @"setting 10.5 cookies" );
-+        #endif
- 		// 10.5.x Leopard
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlus]		forKey:@"31_29_28_19_18_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMinus]		forKey:@"31_30_28_19_18_"];	
-@@ -78,6 +92,24 @@
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu_Hold]	forKey:@"31_19_18_31_19_18_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay_Hold]	forKey:@"35_31_19_18_35_31_19_18_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteControl_Switched]	forKey:@"19_"];			
-+    }    
-+    else
-+    {
-+        #ifdef DEBUG
-+            NSLog( @"setting 10.6 cookies" );
-+        #endif
-+        // 10.6.x Snow Leopard
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlus]		forKey:@"33_31_30_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMinus]		forKey:@"33_32_30_21_20_2_"];	
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu]		forKey:@"33_22_21_20_2_33_22_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay]		forKey:@"33_23_21_20_2_33_23_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonRight]		forKey:@"33_24_21_20_2_33_24_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonLeft]		forKey:@"33_25_21_20_2_33_25_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonRight_Hold]	forKey:@"33_21_20_14_12_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonLeft_Hold]	forKey:@"33_21_20_13_12_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu_Hold]	forKey:@"33_21_20_2_33_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay_Hold]	forKey:@"37_33_21_20_2_37_33_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteControl_Switched]	forKey:@"19_"];
- 	}
- }
- 
diff --git a/patches/dev300/apply b/patches/dev300/apply
index 1871f55..113a1e9 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apply
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apply
@@ -665,6 +665,8 @@ sw-ww8font-fix.diff, cbosdo
 sw-show-Remove-Hyperlink-even-with-selection.diff, alvarezp2000
 sw-preserve-char-style-on-reset-format.diff, i#47893, alvarezp2000
 
+sw-rtf-num-fix.diff, n#569266, cbosdo
+
 # Refresh the cell formatting after pasting in it
 sw-paste-table.diff, n#564789, cbosdo
 
@@ -871,7 +873,7 @@ calc-general-type-auto-decimal-officecfg.diff, n#541973, i#46511, kohei
 calc-general-type-auto-decimal-sc-dbf-fix.diff, i#111074, kohei
 
 # Disable text wrap for numeric values.
-calc-general-type-auto-decimal-disable-linebreak.diff, kohei
+calc-general-type-auto-decimal-disable-linebreak.diff, i#111387, kohei
 
 # Tweak the default display format to hide the ugliness of IEEE 754 rounding error.
 calc-general-type-auto-decimal-ieee754-fix.diff, i#111533, kohei
@@ -1188,6 +1190,9 @@ mysqlcppconn-static-mysql-binding.diff, pmladek
 # Push fonts into the ps stream always
 pushfont-psstream.diff, i#84481, michael
 
+# ignore gcj; OOo newer worked well with it
+jvmfwk-disable-gcj.diff
+
 [ BrokenSystemNSS ]
 # fix build with system libnss installed apart from mozilla
 # strictly required on SL10.1/SLED10 where the xulrunner-nss.pc is broken
@@ -1250,7 +1255,7 @@ transex3-localize-gsicheck-path.diff, i#109378, pmladek
 [ Fixes < dev300-m66 ]
 armeabi-softfp-buildfix.diff, i#105302, doko
 
-[ Fixes and not Win32Only ]
+[ Fixes and not Win32Only and not MacOSXOnly ]
 # fix ARM bridges
 fix-arm-eabi-bridge.diff, i#105359, cmc
 
@@ -2333,6 +2338,9 @@ qt-moc-detect.diff
 # Fix frame border calculation
 kde4-border-frame.diff, i#111464, jholesov
 
+# redraw the status bar when needed; backport from CWS vcl109; fix by pl
+kde4-statusbar-redrawing.diff, bnc#567886, i#107945, pmladek
+
 [ KDE4Experimental ]
 # Not yet ported to co-exist with the KDE3 stuff
 kde4-kab.diff
@@ -2559,8 +2567,6 @@ novell-win32-msi-patchability.diff, tml
 
 [ MacOSXOnly ]
 SectionOwner => thorsten
-# backport from 3.3, enables apple remote for newer systems
-apple-remote-update.diff, i#107648, thorsten
 sfx2-global-scope-fix.diff, thorsten
 cws-kohei03-sc-macfix.diff, thorsten
 
@@ -3904,8 +3910,9 @@ transogl-crossplatform.diff, ericb
 # embed generic media files inside odf docs, 1st part
 # FIXME: svx-sound.diff depends on this diff
 cws-impressmedia01-backport.diff, i#83753, thorsten
-
+cws-impressmedia01-slotparams-fix.diff, n#597691, thorsten
 cws-impressmedia01-crash-fix.diff, n#588570, thorsten
+cws-impressmedia01-linkfix.diff, thorsten
 
 [ Fixes ]
 svx-sound.diff, n#515553, rodo
diff --git a/patches/dev300/build-java-1.4-enable.diff b/patches/dev300/build-java-1.4-enable.diff
index 7a5fd2d..89fbd69 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/build-java-1.4-enable.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/build-java-1.4-enable.diff
@@ -13,7 +13,7 @@
          JAVA_HOME=`echo $JAVAINTERPRETER | $SED -n "s,//*bin//*java,,p"`
 --- jvmfwk/distributions/OpenOfficeorg/javavendors_linux.xml.old	2009-02-12 14:50:55.000000000 +0100
 +++ jvmfwk/distributions/OpenOfficeorg/javavendors_linux.xml	2009-02-19 12:07:59.000000000 +0100
-@@ -7,19 +7,19 @@
+@@ -7,16 +7,16 @@
   
   <vendorInfos> 
    <vendor name="Sun Microsystems Inc.">
@@ -28,10 +28,6 @@
 -    <minVersion>1.5.0</minVersion>
 +    <minVersion>1.4.2</minVersion>
    </vendor>
-   <vendor name="Free Software Foundation, Inc.">
--    <minVersion>1.5.0</minVersion>
-+    <minVersion>1.4.2</minVersion>
-   </vendor>
    <vendor name="BEA Systems, Inc.">
 -    <minVersion>1.5.0</minVersion>
 +    <minVersion>1.4.1</minVersion>
diff --git a/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff b/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff
index 3981a13..86d3470 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff
@@ -49,19 +49,19 @@ index 0ce77fb..d303e45 100644
          if (nScript == 0) nScript = ScGlobal::GetDefaultScriptType();
  
 diff --git sc/source/ui/view/output2.cxx sc/source/ui/view/output2.cxx
-index 35f48bf..301a973 100644
+index 8c7e649..ad3549f 100644
 --- sc/source/ui/view/output2.cxx
 +++ sc/source/ui/view/output2.cxx
 @@ -75,6 +75,8 @@
  #include "scmod.hxx"
  #include "fillinfo.hxx"
  
-+#include <boost/scoped_ptr.hpp>
++#include <boost/ptr_container/ptr_vector.hpp>
 +
  #include <math.h>
  
  //!	Autofilter-Breite mit column.cxx zusammenfassen
-@@ -1324,10 +1326,6 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
+@@ -1344,10 +1346,6 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
  
      ScDrawStringsVars aVars( this, bPixelToLogic );
  
@@ -72,7 +72,7 @@ index 35f48bf..301a973 100644
      BOOL bProgress = FALSE;
  
      long nInitPosX = nScrX;
-@@ -1350,6 +1348,13 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
+@@ -1370,6 +1368,13 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
      SvxCellHorJustify eOutHorJust = SVX_HOR_JUSTIFY_STANDARD;
      const ScPatternAttr* pPattern = NULL;
      const SfxItemSet* pCondSet = NULL;
@@ -80,13 +80,13 @@ index 35f48bf..301a973 100644
 +    const SfxItemSet* pOldCondSet = NULL;
 +    BYTE nOldScript = 0;
 +
-+    // alternative pattern instance in case we need to modify the pattern 
++    // alternative pattern instances in case we need to modify the pattern 
 +    // before processing the cell value.
-+    ::boost::scoped_ptr<ScPatternAttr> pAltPattern;
++    ::boost::ptr_vector<ScPatternAttr> aAltPatterns;
  
      long nPosY = nScrY;
      for (SCSIZE nArrY=1; nArrY+1<nArrCount; nArrY++)
-@@ -1487,6 +1492,17 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
+@@ -1507,6 +1512,18 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
                          pCondSet = pDoc->GetCondResult( nCellX, nCellY, nTab );
                      }
  
@@ -95,10 +95,11 @@ index 35f48bf..301a973 100644
 +                            pPattern->GetItem(ATTR_LINEBREAK, pCondSet)).GetValue())
 +                    {
 +                        // Disable line break when the cell content is numeric.
-+                        pAltPattern.reset(new ScPatternAttr(*pPattern));
++                        aAltPatterns.push_back(new ScPatternAttr(*pPattern));
++                        ScPatternAttr* pAltPattern = &aAltPatterns.back();
 +                        SfxBoolItem aLineBreak(ATTR_LINEBREAK, false);
 +                        pAltPattern->GetItemSet().Put(aLineBreak);
-+                        pPattern = pAltPattern.get();
++                        pPattern = pAltPattern;
 +                    }
 +
                      BYTE nScript = GetScriptType( pDoc, pCell, pPattern, pCondSet );
diff --git a/patches/dev300/cws-impressmedia01-linkfix.diff b/patches/dev300/cws-impressmedia01-linkfix.diff
new file mode 100644
index 0000000..78ab0c6
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-linkfix.diff
@@ -0,0 +1,36 @@
+Replace Package uri with relative path, for embedded media
+
+From: Thorsten Behrens <tbehrens@novell.com>
+
+
+---
+
+ xmloff/source/draw/shapeexport2.cxx       |   14 +++++++++++++-
+ 1 files changed, 34 insertions(+), 2 deletions(-)
+
+
+diff --git xmloff/source/draw/shapeexport2.cxx xmloff/source/draw/shapeexport2.cxx
+index 2a10dc2..1137372 100644
+--- xmloff/source/draw/shapeexport2.cxx
++++ xmloff/source/draw/shapeexport2.cxx
+@@ -1966,7 +1966,19 @@ void XMLShapeExport::ImpExportMediaShape(
+         // export media url
+         OUString aMediaURL;
+         xPropSet->getPropertyValue( OUString( RTL_CONSTASCII_USTRINGPARAM( "MediaURL" ) ) ) >>= aMediaURL;
+-        mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_HREF, GetExport().GetRelativeReference( aMediaURL ) );
++
++        const rtl::OUString sPackageURL( RTL_CONSTASCII_USTRINGPARAM("vnd.sun.star.Package:") );
++        if( aMediaURL.match( sPackageURL, 0 ) )
++        {
++            // embedded media, strip package prefix
++            aMediaURL = aMediaURL.copy( sPackageURL.getLength(), 
++                                        aMediaURL.getLength() - sPackageURL.getLength() );
++        }
++        else
++        {
++            aMediaURL = GetExport().GetRelativeReference( aMediaURL );
++        }
++        mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_HREF, aMediaURL );
+         mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_TYPE, XML_SIMPLE );
+         mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_SHOW, XML_EMBED );
+         mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_ACTUATE, XML_ONLOAD );
diff --git a/patches/dev300/cws-impressmedia01-slotparams-fix.diff b/patches/dev300/cws-impressmedia01-slotparams-fix.diff
new file mode 100644
index 0000000..1a4f2df
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-slotparams-fix.diff
@@ -0,0 +1,85 @@
+Give additional slot call parameters for SID_INSERT_AVMEDIA
+
+From: Thorsten Behrens <tbehrens@novell.com>
+
+
+---
+
+ avmedia/source/framework/mediaplayer.cxx |    8 +++++++-
+ sc/source/ui/view/tabvwsh9.cxx           |    4 +++-
+ sd/source/ui/view/drviews9.cxx           |    4 +++-
+ sw/source/ui/shells/basesh.cxx           |    4 +++-
+ 4 files changed, 16 insertions(+), 4 deletions(-)
+
+
+diff --git avmedia/source/framework/mediaplayer.cxx avmedia/source/framework/mediaplayer.cxx
+index 1042c8e..8f172ff 100644
+--- avmedia/source/framework/mediaplayer.cxx
++++ avmedia/source/framework/mediaplayer.cxx
+@@ -36,6 +36,7 @@
+ #include "helpids.hrc"
+ 
+ #include <svtools/stritem.hxx>
++#include <svtools/eitem.hxx>
+ #include <sfx2/app.hxx>
+ #include <sfx2/sfxsids.hrc>
+ #include <sfx2/bindings.hxx>
+@@ -162,7 +163,12 @@ void MediaFloater::dispatchCurrentURL()
+     if( pDispatcher )
+     {	
+         const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, getURL() );
+-        pDispatcher->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_RECORD, &aMediaURLItem, 0L );
++        const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++        pDispatcher->Execute( SID_INSERT_AVMEDIA, 
++                              SFX_CALLMODE_RECORD, 
++                              &aMediaURLItem, 
++                              &aLinkFlagItem, 
++                              0L );
+     }
+ }
+ 
+diff --git sc/source/ui/view/tabvwsh9.cxx sc/source/ui/view/tabvwsh9.cxx
+index 88ebdc9..8ea0417 100644
+--- sc/source/ui/view/tabvwsh9.cxx
++++ sc/source/ui/view/tabvwsh9.cxx
+@@ -154,7 +154,9 @@ void ScTabViewShell::ExecGallery( SfxRequest& rReq )
+                 if ( pGal )
+                 {
+                     const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+-                       GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
++                    const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++                       GetViewFrame()->GetDispatcher()->Execute( 
++                           SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
+                 }
+             }
+         }
+diff --git sd/source/ui/view/drviews9.cxx sd/source/ui/view/drviews9.cxx
+index 57064c6..0f8dd8c 100644
+--- sd/source/ui/view/drviews9.cxx
++++ sd/source/ui/view/drviews9.cxx
+@@ -220,7 +220,9 @@ void DrawViewShell::ExecGallery(SfxRequest& rReq)
+             else if( nFormats & SGA_FORMAT_SOUND )
+             {
+                 const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+-                   GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
++                const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++                GetViewFrame()->GetDispatcher()->Execute( 
++                    SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
+             }
+ 
+             GetDocSh()->SetWaitCursor( FALSE );
+diff --git sw/source/ui/shells/basesh.cxx sw/source/ui/shells/basesh.cxx
+index a32d3e1..c891e53 100644
+--- sw/source/ui/shells/basesh.cxx
++++ sw/source/ui/shells/basesh.cxx
+@@ -776,7 +776,9 @@ void SwBaseShell::Execute(SfxRequest &rReq)
+                 else if(!rSh.IsSelFrmMode() && SGA_FORMAT_SOUND & ((SfxUInt32Item*)pItem)->GetValue())
+                 {
+                     const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+-                       GetView().GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
++                    const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++                       GetView().GetViewFrame()->GetDispatcher()->Execute( 
++                           SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
+ /*
+                     String sURL( pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+                     String sLabel( pGal->GetURL().getBase() );
diff --git a/patches/dev300/go-oo-team.diff b/patches/dev300/go-oo-team.diff
index 1ce6b97..a1cd38e 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/go-oo-team.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/go-oo-team.diff
@@ -11,7 +11,7 @@
 +
 +String STR_GO_OO_TEAM_NAMES
 +{
-+    TEXT = "From top left: Andreas, Bernhard, David, Dhananjay, Eric, Federico, Fong\nFridrich, Giuseppe, Hubert, Jakub, Jan, Jan, Jiao\nJody, Kai, Kalman, Kohei, Martin, Matthias, Michael\nMike, Miklos, Noel, Petr, Radek, Rene, Silvan\nThorsten, Tor, Volker, Yin, ZhangYun.\n";
++    TEXT = "From top left: Andreas, Bernhard, Cedric, David, Dhananjay, Eric, Federico\nFong, Fridrich, Giuseppe, Hubert, Jakub, Jan, Jan\nJiao, Jody, Kai, Kalman, Kohei, Martin, Matthias\nMichael, Mike, Miklos, Noel, Petr, Radek, Rene\nSilvan, Thorsten, Tor, Volker, Wei, Yin, ZhangYun.\n";
 +};
 +
 --- sw/source/ui/dochdl/gloshdl.cxx.old	2009-10-08 16:17:19.000000000 +0200
diff --git a/patches/dev300/jvmfwk-disable-gcj.diff b/patches/dev300/jvmfwk-disable-gcj.diff
new file mode 100644
index 0000000..5f100dc
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/jvmfwk-disable-gcj.diff
@@ -0,0 +1,20 @@
+--- jvmfwk/distributions/OpenOfficeorg/javavendors_linux.xml.old	2010-04-28 11:35:17.000000000 +0200
++++ jvmfwk/distributions/OpenOfficeorg/javavendors_linux.xml	2010-05-20 17:23:46.000000000 +0200
+@@ -15,9 +15,6 @@
+   <vendor name="Blackdown Java-Linux Team">
+     <minVersion>1.5.0</minVersion>
+   </vendor>
+-  <vendor name="Free Software Foundation, Inc.">
+-    <minVersion>1.5.0</minVersion>
+-  </vendor>
+   <vendor name="BEA Systems, Inc.">
+     <minVersion>1.5.0</minVersion>
+   </vendor>
+@@ -27,7 +24,6 @@
+   <library vendor="Sun Microsystems Inc.">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.so</library>
+   <library vendor="IBM Corporation">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.so</library>
+   <library vendor="Blackdown Java-Linux Team">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.so</library>
+-  <library vendor="Free Software Foundation, Inc.">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.so</library>
+   <library vendor="BEA Systems, Inc.">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.so</library>
+  </plugins>
+ </javaSelection>
diff --git a/patches/dev300/kde4-statusbar-redrawing.diff b/patches/dev300/kde4-statusbar-redrawing.diff
new file mode 100644
index 0000000..2a91ff7
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/kde4-statusbar-redrawing.diff
@@ -0,0 +1,85 @@
+--- vcl/unx/kde4/KDESalGraphics.cxx.old	2010-05-14 20:00:31.000000000 +0200
++++ vcl/unx/kde4/KDESalGraphics.cxx	2010-05-24 13:37:29.000000000 +0200
+@@ -228,6 +228,8 @@ BOOL KDESalGraphics::drawNativeControl( 
+ 							 QImage::Format_ARGB32);
+ 		m_image->fill(KApplication::palette().color(QPalette::Window).rgb());
+ 	}
++    
++    XLIB_Region pTempClipRegion = 0;
+ 	
+     if (type == CTRL_PUSHBUTTON)
+     {
+@@ -451,6 +453,19 @@ BOOL KDESalGraphics::drawNativeControl( 
+     {
+ 		lcl_drawFrame(QStyle::PE_Frame, m_image, 
+ 					  vclStateValue2StateFlag(nControlState, value));
++        
++        int size = kapp->style()->pixelMetric(QStyle::PM_LayoutLeftMargin);
++        pTempClipRegion = XCreateRegion();
++        XRectangle xRect = { widgetRect.left(), widgetRect.top(), widgetRect.width(), widgetRect.height() };
++        XUnionRectWithRegion( &xRect, pTempClipRegion, pTempClipRegion );
++        XLIB_Region pSubtract = XCreateRegion();
++        xRect.x += size;
++        xRect.y += size;
++        xRect.width -= 2* size;
++        xRect.height -= 2*size;
++        XUnionRectWithRegion( &xRect, pSubtract, pSubtract );
++        XSubtractRegion( pTempClipRegion, pSubtract, pTempClipRegion );
++        XDestroyRegion( pSubtract );
+     }
+     else if (type == CTRL_FIXEDBORDER)
+     {
+@@ -472,24 +487,42 @@ BOOL KDESalGraphics::drawNativeControl( 
+     }
+     else
+     {
+-        return false;
++        returnVal = false;
+ 	}
+ 
+ 	if (returnVal)
+ 	{
+-		if( SelectFont() == 0 )
+-			return false;
+-		
+-		QPixmap pixmap = QPixmap::fromImage(*m_image, Qt::ColorOnly | Qt::OrderedDither | Qt::OrderedAlphaDither);
+-		X11SalGraphics::CopyScreenArea( GetXDisplay(),
+-			pixmap.handle(), pixmap.x11Info().screen(), pixmap.x11Info().depth(),
+-			GetDrawable(), GetScreenNumber(), GetVisual().GetDepth(),
+-			SelectFont(), 0, 0, widgetRect.width(), widgetRect.height(), widgetRect.left(), widgetRect.top());
++                GC gc = SelectFont();
+ 		
+-		return true;
++                if( gc )
++                {
++                    if( pTempClipRegion )
++                    {
++                        if( pClipRegion_ )
++                            XIntersectRegion( pTempClipRegion, pClipRegion_, pTempClipRegion );
++                        XSetRegion( GetXDisplay(), gc, pTempClipRegion );
++                    }
++                    QPixmap pixmap = QPixmap::fromImage(*m_image, Qt::ColorOnly | Qt::OrderedDither | Qt::OrderedAlphaDither);
++                    X11SalGraphics::CopyScreenArea( GetXDisplay(),
++                                pixmap.handle(), pixmap.x11Info().screen(), pixmap.x11Info().depth(),
++                                GetDrawable(), GetScreenNumber(), GetVisual().GetDepth(),
++                                gc, 0, 0, widgetRect.width(), widgetRect.height(), widgetRect.left(), widgetRect.top());
++
++                    if( pTempClipRegion )
++                    {
++                        if( pClipRegion_ )
++                            XSetRegion( GetXDisplay(), gc, pClipRegion_ );
++                        else
++                            XSetClipMask( GetXDisplay(), gc, None );
++        	}
++        }
++        else
++            returnVal = false;
+ 	}
++    if( pTempClipRegion )
++        XDestroyRegion( pTempClipRegion );
+ 	
+-	return false;
++    return returnVal;
+ }
+ 
+ BOOL KDESalGraphics::getNativeControlRegion( ControlType type, ControlPart part,
diff --git a/patches/dev300/layout-generate-localize-sdf.diff b/patches/dev300/layout-generate-localize-sdf.diff
index b5fa21e..2a15595 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/layout-generate-localize-sdf.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/layout-generate-localize-sdf.diff
@@ -46,9 +46,9 @@
  template.sdf:
 -    $(foreach,i,$(XML_FILES) $(TRALAY) -l en-US $i) > $@
 +    $(foreach,i,$(XML_FILES) $(TRALAY) -l en-US "$i") > $@
---- svx/uiconfig/layout/makefile.mk.old	2010-02-18 13:58:56.000000000 +0100
-+++ svx/uiconfig/layout/makefile.mk	2010-02-18 18:17:41.000000000 +0100
-@@ -40,9 +40,8 @@ TARGET=layout
+--- svx/uiconfig/layout/makefile.mk.orig	2010-05-13 19:00:54.000000000 +0200
++++ svx/uiconfig/layout/makefile.mk	2010-05-20 21:15:08.000000000 +0200
+@@ -36,9 +36,8 @@ TARGET=layout
  all: ALLTAR
  
  XML_FILES=\
@@ -60,16 +60,16 @@
  
  .INCLUDE : layout.mk
  
-@@ -52,8 +51,24 @@ all .PHONY:
+@@ -48,8 +47,33 @@ all .PHONY:
  
  .INCLUDE :  target.mk
  
 -localize.sdf: $(PRJ)/source/dialog/localize.sdf
 -	grep srchdlg.src $(PRJ)/source/dialog/localize.sdf | awk -F'\t' '{{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "svx\\uiconfig\\layout\\find-and-replace.xml", $$3, "layout", $$5 $$6 "_label", "", "", $$8, "0", $$10, $$11, $$12, "", $$14, $$15}}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\tRID_SVXDLG_SEARCH/\t/' -e 's/\t_label/\tRID_SVXDLG_SEARCH_title/' > find-and-replace-$@
 -	grep zoom.src $(PRJ)/source/dialog/localize.sdf | awk -F'\t' '{{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "svx\\uiconfig\\layout\\zoom.xml", $$3, "layout", $$5 $$6 "_label", "", "", $$8, "0", $$10, $$11, $$12, "", $$14, $$15}}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\tRID_SVXDLG_ZOOM/\t/' -e 's/\t_label/\tRID_SVXDLG_ZOOM_title/' > zoom-$@
-+localize.sdf: $(COMMONMISC)$/$(PRJNAME)$/source$/dialog$/localize.sdf
++localize.sdf: $(COMMONMISC)$/$(PRJNAME)$/source$/dialog$/localize.sdf $(COMMONMISC)$/$(PRJNAME)$/source$/cui$/localize.sdf
 +	grep srchdlg.src $(COMMONMISC)$/$(PRJNAME)$/source$/dialog$/localize.sdf | awk -F'\t' '{{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "svx\\uiconfig\\layout\\find-and-replace.xml", $$3, "layout", $$5 $$6 "_label", "", "", $$8, "0", $$10, $$11, $$12, "", $$14, $$15}}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\tRID_SVXDLG_SEARCH/\t/' -e 's/\t_label/\tRID_SVXDLG_SEARCH_title/' > find-and-replace-$@
-+	grep zoom.src $(COMMONMISC)$/$(PRJNAME)$/source$/dialog$/localize.sdf | awk -F'\t' '{{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "svx\\uiconfig\\layout\\zoom.xml", $$3, "layout", $$5 $$6 "_label", "", "", $$8, "0", $$10, $$11, $$12, "", $$14, $$15}}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\tRID_SVXDLG_ZOOM/\t/' -e 's/\t_label/\tRID_SVXDLG_ZOOM_title/' > zoom-$@
++	grep zoom.src $(COMMONMISC)$/$(PRJNAME)$/source$/cui$/localize.sdf | awk -F'\t' '{{printf "%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n", "layout", "svx\\uiconfig\\layout\\zoom.xml", $$3, "layout", $$5 $$6 "_label", "", "", $$8, "0", $$10, $$11, $$12, "", $$14, $$15}}' | sed -e 's/\(\(FL\|STR\)_[^\t]*\)_label/\1_text/' -e 's/\tRID_SVXDLG_ZOOM/\t/' -e 's/\t_label/\tRID_SVXDLG_ZOOM_title/' > zoom-$@
  	echo '#empty' | cat - find-and-replace-$@ zoom-$@ > $@
  	rm -f *-$@
 +
@@ -81,12 +81,21 @@
 +    -unzip -o -d $(COMMONMISC)$/$(PRJNAME) $(SOLARCOMMONSDFDIR)$/$(PRJNAME).zip $(subst,$(COMMONMISC)$/$(PRJNAME)$/, $@)
 +    $(TOUCH) $@
 +
++$(COMMONMISC)$/$(PRJNAME)$/source$/cui$/localize.sdf : $(SOLARCOMMONSDFDIR)$/$(PRJNAME).zip
++    @@-$(MKDIRHIER) $(@:d)
++    -unzip -o -d $(COMMONMISC)$/$(PRJNAME) $(SOLARCOMMONSDFDIR)$/$(PRJNAME).zip $(subst,$(COMMONMISC)$/$(PRJNAME)$/, $@)
++    $(TOUCH) $@
++
 +.ELSE
 +
 +$(COMMONMISC)$/$(PRJNAME)$/source$/dialog$/localize.sdf :
 +    @@-$(MKDIRHIER) $(@:d)
 +    $(TOUCH) $@
 +
++$(COMMONMISC)$/$(PRJNAME)$/source$/cui$/localize.sdf :
++    @@-$(MKDIRHIER) $(@:d)
++    $(TOUCH) $@
++
 +.ENDIF # "$(WITH_LANG)"!=""
 --- sc/uiconfig/layout/makefile.mk.old	2010-02-18 13:58:56.000000000 +0100
 +++ sc/uiconfig/layout/makefile.mk	2010-02-18 17:30:57.000000000 +0100
diff --git a/patches/dev300/mdds-makefile-mk.diff b/patches/dev300/mdds-makefile-mk.diff
index b485edf..57d1945 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/mdds-makefile-mk.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/mdds-makefile-mk.diff
@@ -1,6 +1,6 @@
 --- /dev/null	
 +++ mdds/makefile.mk	
-@@ -0,0 +1,66 @@
+@@ -0,0 +1,69 @@
 +#*************************************************************************
 +#
 +# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
@@ -61,9 +61,12 @@
 +
 +# --- post-build ---------------------------------------------------
 +
++NORMALIZE_FLAG_FILE=so_normalized_$(TARGET)
++
 +$(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE) : $(PACKAGE_DIR)$/$(BUILD_FLAG_FILE)
 +	-@$(MKDIRHIER) $(INCCOM)
-+	@$(GNUCOPY) -r $(PACKAGE_DIR)/$(TARFILE_NAME)/inc/mdds $(INCCOM)/
++	@$(GNUCOPY) -r $(PACKAGE_DIR)$/$(TARFILE_NAME)$/inc$/mdds $(INCCOM)
++	@$(TOUCH) $(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE)
 +
 +$(PACKAGE_DIR)$/$(PREDELIVER_FLAG_FILE) : $(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE)
 +
diff --git a/patches/dev300/ooxml-filters.diff b/patches/dev300/ooxml-filters.diff
index 5c619d0..ae3c1a3 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/ooxml-filters.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/ooxml-filters.diff
@@ -299,14 +299,15 @@ index 2e354c8..43447cb 100644
 +</node>
 --- /dev/null
 +++ filter/source/config/fragments/filters/impress_OOXML.xcu
-@@ -0,0 +1,11 @@
+@@ -0,0 +1,12 @@
 +<node oor:name="Impress Office Open XML" oor:op="replace">
 +    <prop oor:name="Flags"><value>IMPORT EXPORT ALIEN 3RDPARTYFILTER PREFERRED</value></prop>
 +    <prop oor:name="UIComponent"/>
 +    <prop oor:name="FilterService"><value>com.sun.star.comp.Impress.oox.PowerPointImport</value></prop>
 +    <prop oor:name="UserData"><value>OOXML</value></prop>
 +    <prop oor:name="UIName"><value xml:lang="x-default">Office Open XML Presentation</value></prop>
-+    <prop oor:name="FileFormatVersion"/>
++    <!-- ISO/IEC 29500:2008 -->
++    <prop oor:name="FileFormatVersion"><value>1</value></prop>
 +    <prop oor:name="Type"><value>Office Open XML Presentation</value></prop>
 +    <prop oor:name="TemplateName"/>
 +    <prop oor:name="DocumentService"><value>com.sun.star.presentation.PresentationDocument</value></prop>
@@ -323,14 +324,15 @@ index 2e354c8..43447cb 100644
      <prop oor:name="TemplateName"/>
 --- /dev/null
 +++ filter/source/config/fragments/filters/impress_OOXML_Template.xcu
-@@ -0,0 +1,11 @@
+@@ -0,0 +1,12 @@
 +<node oor:name="Impress Office Open XML Template" oor:op="replace">
 +    <prop oor:name="Flags"><value>IMPORT EXPORT ALIEN 3RDPARTYFILTER TEMPLATE TEMPLATEPATH PREFERRED</value></prop>
 +    <prop oor:name="UIComponent"/>
 +    <prop oor:name="FilterService"><value>com.sun.star.comp.Impress.oox.PowerPointImport</value></prop>
 +    <prop oor:name="UserData"><value>OOXML</value></prop>
 +    <prop oor:name="UIName"><value xml:lang="x-default">Office Open XML Presentation Template</value></prop>
-+    <prop oor:name="FileFormatVersion"/>
++    <!-- ISO/IEC 29500:2008 -->
++    <prop oor:name="FileFormatVersion"><value>1</value></prop>
 +    <prop oor:name="Type"><value>Office Open XML Presentation Template</value></prop>
 +    <prop oor:name="TemplateName"/>
 +    <prop oor:name="DocumentService"><value>com.sun.star.presentation.PresentationDocument</value></prop>
diff --git a/patches/dev300/soffice-opengl-and-locking-config.diff b/patches/dev300/soffice-opengl-and-locking-config.diff
index 62052d9..07842ac 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/soffice-opengl-and-locking-config.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/soffice-opengl-and-locking-config.diff
@@ -17,7 +17,7 @@ Index: soffice.sh
 +# helper functions
 +home_on_nfs()
 +{
-+    case $(stat -f -c %T $HOME) in nfs|smb)
++    case $(stat -f -c %T $HOME) in cifs|nfs|smb)
 +        return 0
 +    esac
 +    return 1
@@ -26,7 +26,7 @@ Index: soffice.sh
 +    for i; do
 +       case "$i" in -*) continue; esac
 +       [ -f "$i" ] || continue
-+       case $(stat -f -c %T "$i") in nfs|smb)
++       case $(stat -f -c %T "$i") in cifs|nfs|smb)
 +            return 0
 +       esac
 +    done
@@ -151,7 +151,7 @@ Index: soffice.sh
 +# helper functions
 +home_on_nfs()
 +{
-+    case $(stat -f -c %T $HOME) in nfs*|smb)
++    case $(stat -f -c %T $HOME) in cifs|nfs*|smb)
 +        return 0
 +    esac
 +    return 1
@@ -160,7 +160,7 @@ Index: soffice.sh
 +    for i; do
 +       case "$i" in -*) continue; esac
 +       [ -f "$i" ] || continue
-+       case $(stat -f -c %T "$i") in nfs*|smb)
++       case $(stat -f -c %T "$i") in cifs|nfs*|smb)
 +            return 0
 +       esac
 +    done
diff --git a/patches/dev300/sw-rtf-num-fix.diff b/patches/dev300/sw-rtf-num-fix.diff
new file mode 100644
index 0000000..d35703b
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/sw-rtf-num-fix.diff
@@ -0,0 +1,203 @@
+RTF numbering roundtrip fixes
+
+From: CÃ©dric Bosdonnat <cedricbosdo@openoffice.org>
+
+
+---
+
+ sw/source/filter/rtf/rtfatr.cxx |   12 +++++----
+ sw/source/filter/rtf/rtfnum.cxx |   52 +++++++++++++++++++--------------------
+ 2 files changed, 31 insertions(+), 33 deletions(-)
+
+
+diff --git sw/source/filter/rtf/rtfatr.cxx sw/source/filter/rtf/rtfatr.cxx
+index 6da9f86..56d34e8 100644
+--- sw/source/filter/rtf/rtfatr.cxx
++++ sw/source/filter/rtf/rtfatr.cxx
+@@ -448,15 +448,15 @@ bool SwFmtToSet(SwRTFWriter& rWrt, const SwFmt& rFmt, SfxItemSet &rSet)
+                 }
+ 
+                 const SwNumFmt* pNFmt = &rWrt.pDoc->GetOutlineNumRule()->Get( static_cast<USHORT>(nLvl) );
+-                if( pNFmt->GetAbsLSpace() )
++                if( pNFmt->GetIndentAt() )
+                 {
+                     SfxItemSet aSet( *rFmt.GetAttrSet().GetPool(),
+                                     rFmt.GetAttrSet().GetRanges() );
+                     aSet.SetParent( &rFmt.GetAttrSet() );
+                     SvxLRSpaceItem aLR( (SvxLRSpaceItem&)aSet.Get( RES_LR_SPACE ) );
+ 
+-                    aLR.SetTxtLeft( aLR.GetTxtLeft() + pNFmt->GetAbsLSpace() );
+-                    aLR.SetTxtFirstLineOfst( pNFmt->GetFirstLineOffset() );
++                    aLR.SetTxtLeft( aLR.GetTxtLeft() + pNFmt->GetIndentAt() );
++                    aLR.SetTxtFirstLineOfst( pNFmt->GetFirstLineIndent() );
+ 
+                     aSet.Put(aLR);
+                     rSet.Put(aSet);
+@@ -1220,7 +1220,7 @@ static Writer& OutRTF_SwTxtNode( Writer& rWrt, SwCntntNode& rNode )
+     }
+ 
+     // gibt es harte Attributierung ?
+-    if( bNewFmts && pNd->HasSwAttrSet())
++    if( pNd->HasSwAttrSet() )
+     {
+         rRTFWrt.pFlyFmt = 0;
+ 
+@@ -1243,9 +1243,9 @@ static Writer& OutRTF_SwTxtNode( Writer& rWrt, SwCntntNode& rNode )
+             SfxItemSet aSet( rNdSet );
+             SvxLRSpaceItem aLR( (SvxLRSpaceItem&)rNdSet.Get( RES_LR_SPACE ) );
+ 
+-            aLR.SetTxtLeft( aLR.GetTxtLeft() + pFmt->GetAbsLSpace() );
++            aLR.SetTxtLeft( aLR.GetTxtLeft() + pFmt->GetIndentAt() );
+             if( MAXLEVEL > pNd->GetActualListLevel() )
+-                aLR.SetTxtFirstLineOfst( pFmt->GetFirstLineOffset() );
++                aLR.SetTxtFirstLineOfst( pFmt->GetFirstLineIndent() );
+             else
+                 aSet.ClearItem( RES_PARATR_NUMRULE );
+             aSet.Put( aLR );
+diff --git sw/source/filter/rtf/rtfnum.cxx sw/source/filter/rtf/rtfnum.cxx
+index 0616b96..f1b9067 100644
+--- sw/source/filter/rtf/rtfnum.cxx
++++ sw/source/filter/rtf/rtfnum.cxx
+@@ -43,6 +43,7 @@
+ #include <svx/colritem.hxx>
+ #include <svx/udlnitem.hxx>
+ #include <svx/wrlmitem.hxx>
++#include <svx/numitem.hxx>
+ #include <shellio.hxx>
+ #include <fltini.hxx>
+ #include <swtypes.hxx>
+@@ -72,7 +73,7 @@ void lcl_ExpandNumFmts( SwNumRule& rRule )
+         if( !rRule.GetNumFmt( n ) )
+         {
+             SwNumFmt aNumFmt( rRule.Get( 0 ));
+-            aNumFmt.SetAbsLSpace( aNumFmt.GetAbsLSpace() * ( n + 1 ) );
++            aNumFmt.SetIndentAt( aNumFmt.GetIndentAt() * ( n + 1 ) );
+             rRule.Set( n, aNumFmt );
+         }
+ }
+@@ -99,13 +100,13 @@ void SwRTFParser::ReadListLevel( SwNumRule& rRule, BYTE nNumLvl )
+     int nLvlTxtLevel = 0, nLvlNumberLevel = 0;
+     String sLvlText, sLvlNumber;
+     SwNumFmt* pCurNumFmt;
+-    String aStringFollow = aEmptyStr;
++    SvxNumberFormat::SvxNumLabelFollowedBy eFollowedBy = SvxNumberFormat::NOTHING;
+ 
+     if( MAXLEVEL >= nNumLvl )
+     {
+         pCurNumFmt = (SwNumFmt*)rRule.GetNumFmt( nNumLvl );
+-        pCurNumFmt->SetAbsLSpace( 0 );
+-        pCurNumFmt->SetFirstLineOffset( 0 );
++        pCurNumFmt->SetIndentAt( 0 );
++        pCurNumFmt->SetFirstLineIndent( 0 );
+     }
+     else
+         pCurNumFmt = 0;
+@@ -210,17 +211,16 @@ void SwRTFParser::ReadListLevel( SwNumRule& rRule, BYTE nNumLvl )
+             break;
+ 
+         case RTF_LEVELFOLLOW:
+-          /* removed; waiting for swnum02 to be integrated!
++          /* removed; waiting for swnum02 to be integrated! */
+             switch (nTokenValue)
+             {
+             case 0:
+-                aStringFollow=String('\t');
++                eFollowedBy = SvxNumberFormat::LISTTAB;
+                 break;
+             case 1:
+-                aStringFollow=String(' ');
++                eFollowedBy = SvxNumberFormat::SPACE;
+                 break;
+             }
+-            */
+             break;
+ 
+         case RTF_LEVELOLD:
+@@ -244,8 +244,8 @@ void SwRTFParser::ReadListLevel( SwNumRule& rRule, BYTE nNumLvl )
+                 // and put the current "LRSpace" into the set
+                 {
+                     SvxLRSpaceItem aLR( RES_LR_SPACE );
+-                    aLR.SetTxtLeft( pCurNumFmt->GetAbsLSpace() );
+-                    aLR.SetTxtFirstLineOfst(pCurNumFmt->GetFirstLineOffset());
++                    aLR.SetTxtLeft( pCurNumFmt->GetIndentAt() );
++                    aLR.SetTxtFirstLineOfst(pCurNumFmt->GetFirstLineIndent());
+                     aSet.Put( aLR );
+                 }
+ 
+@@ -264,8 +264,9 @@ void SwRTFParser::ReadListLevel( SwNumRule& rRule, BYTE nNumLvl )
+                         FALSE, &pItem ))
+                 {
+                     const SvxLRSpaceItem& rLR = *(SvxLRSpaceItem*)pItem;
+-                    pCurNumFmt->SetAbsLSpace( static_cast< short >(rLR.GetTxtLeft()) );
+-                    pCurNumFmt->SetFirstLineOffset( rLR.GetTxtFirstLineOfst());
++                    pCurNumFmt->SetListtabPos( rLR.GetTxtLeft( ) );
++                    pCurNumFmt->SetIndentAt( rLR.GetTxtLeft() );
++                    pCurNumFmt->SetFirstLineIndent( rLR.GetTxtFirstLineOfst());
+                 }
+ 
+                 // dann aus der Vorlage den Font holen
+@@ -306,16 +307,13 @@ void SwRTFParser::ReadListLevel( SwNumRule& rRule, BYTE nNumLvl )
+             pCurNumFmt->SetSuffix( sLvlText );
+         }
+ 
+-        String newSuffix=pCurNumFmt->GetSuffix();
+-        newSuffix+=aStringFollow;
+-        pCurNumFmt->SetSuffix(newSuffix);
+-        /* removed; waiting for swnum02 to be integrated!
+-        if (aStringFollow.GetChar(0)=='\t' && !pCurNumFmt->IsItemize())
++        /* removed; waiting for swnum02 to be integrated!*/
++        pCurNumFmt->SetLabelFollowedBy( eFollowedBy );
++        if (eFollowedBy == SvxNumberFormat::LISTTAB && !pCurNumFmt->IsItemize())
+         {
+-            pCurNumFmt->SetAbsLSpace(0);
+-            pCurNumFmt->SetFirstLineOffset(0);
++            pCurNumFmt->SetIndentAt(0);
++            pCurNumFmt->SetFirstLineIndent(0);
+         }
+-        */
+     }
+ 
+     SkipToken( -1 );
+@@ -380,7 +378,7 @@ void SwRTFParser::ReadListTable()
+ 
+                 String sTmp( String::CreateFromAscii(
+                     RTL_CONSTASCII_STRINGPARAM( RTF_NUMRULE_NAME " 1" )));
+-                aEntry.nListDocPos = pDoc->MakeNumRule( sTmp );
++                aEntry.nListDocPos = pDoc->MakeNumRule( sTmp, 0, FALSE, SvxNumberFormat::LABEL_ALIGNMENT );
+                 pCurRule = pDoc->GetNumRuleTbl()[ aEntry.nListDocPos ];
+                 // --> OD 2008-07-08 #i91400#
+                 pCurRule->SetName( pDoc->GetUniqueNumRuleName( &sTmp, FALSE ),
+@@ -1011,8 +1009,8 @@ NUMATTR_SETUNDERLINE:
+         case RTF_PNINDENT:
+             if( 0 > short( nTokenValue ) )
+                 nTokenValue = - (short)nTokenValue;
+-            pCurNumFmt->SetFirstLineOffset( - short( nTokenValue ));
+-            pCurNumFmt->SetAbsLSpace( (nLevel + 1 ) * USHORT( nTokenValue ));
++            pCurNumFmt->SetFirstLineIndent( - nTokenValue );
++            pCurNumFmt->SetIndentAt( (nLevel + 1 ) * nTokenValue );
+             break;
+         case RTF_PNSP:
+             pCurNumFmt->SetCharTextDistance( USHORT( nTokenValue ));
+@@ -1288,8 +1286,8 @@ void SwRTFWriter::OutRTFListTab()
+             }
+ 
+             Strm() << OOO_STRING_SVTOOLS_RTF_FI;
+-            OutLong( rFmt.GetFirstLineOffset() ) << OOO_STRING_SVTOOLS_RTF_LI;
+-            OutLong( rFmt.GetAbsLSpace() );
++            OutLong( rFmt.GetFirstLineIndent() ) << OOO_STRING_SVTOOLS_RTF_LI;
++            OutLong( rFmt.GetIndentAt() );
+ 
+             Strm() << '}';
+ 
+@@ -1401,9 +1399,9 @@ BOOL SwRTFWriter::OutListNum( const SwTxtNode& rNd )
+         SfxItemSet aSet( *rNdSet.GetPool(), rNdSet.GetRanges() );
+         aSet.SetParent( &rNdSet );
+         SvxLRSpaceItem aLR( (SvxLRSpaceItem&)rNdSet.Get( RES_LR_SPACE ) );
+-        aLR.SetTxtLeft( aLR.GetTxtLeft() + pFmt->GetAbsLSpace() );
++        aLR.SetTxtLeft( aLR.GetTxtLeft() + pFmt->GetIndentAt() );
+ 
+-        aLR.SetTxtFirstLineOfst( pFmt->GetFirstLineOffset() );
++        aLR.SetTxtFirstLineOfst( pFmt->GetFirstLineIndent() );
+         if ( bExportNumRule )
+             Strm() << '{' << OOO_STRING_SVTOOLS_RTF_LISTTEXT << OOO_STRING_SVTOOLS_RTF_PARD << OOO_STRING_SVTOOLS_RTF_PLAIN << ' ';
+ 
diff --git a/patches/dev300/transogl-crossplatform.diff b/patches/dev300/transogl-crossplatform.diff
index 0c9ebe3..5e76c70 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/transogl-crossplatform.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/transogl-crossplatform.diff
@@ -98,17 +98,8 @@ index fbbb575..e2cb301 100644
  mkdir: %_DEST%\inc%_EXT%\boost\mpl
  mkdir: %_DEST%\inc%_EXT%\boost\mpl\aux_
  mkdir: %_DEST%\inc%_EXT%\boost\mpl\aux_\config
-@@ -83,6 +90,8 @@ mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\seq\detail
- mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\slot
- mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\slot\detail
- mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\tuple
-+mkdir: %_DEST%\inc%_EXT%\boost\range
-+mkdir: %_DEST%\inc%_EXT%\boost\range\detail
- mkdir: %_DEST%\inc%_EXT%\boost\spirit
- mkdir: %_DEST%\inc%_EXT%\boost\spirit\actor
- mkdir: %_DEST%\inc%_EXT%\boost\spirit\attribute
 @@ -306,8 +315,18 @@ mkdir: %_DEST%\inc%_EXT%\boost\variant\detail
- ..\%__SRC%\inc\boost\utility\* %_DEST%\inc%_EXT%\boost\utility
+ ..\%__SRC%\inc\boost\utility\detail\* %_DEST%\inc%_EXT%\boost\utility\detail
  ..\%__SRC%\inc\boost\variant\* %_DEST%\inc%_EXT%\boost\variant
  ..\%__SRC%\inc\boost\variant\detail\* %_DEST%\inc%_EXT%\boost\variant\detail
 +..\%__SRC%\misc\build\boost_1_39_0\boost\algorithm\string\* %_DEST%\inc%_EXT%\boost\algorithm\string\
@@ -266,18 +257,15 @@ deleted file mode 100644
 index a144790..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_Shaders.cxx
 +++ /dev/null
-@@ -1,143 +0,0 @@
+@@ -1,140 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: $
-- * $Revision: $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -415,18 +403,15 @@ deleted file mode 100644
 index 049c71f..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_Shaders.hxx
 +++ /dev/null
-@@ -1,71 +0,0 @@
+@@ -1,68 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: $
-- * $Revision: $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -492,18 +477,15 @@ deleted file mode 100644
 index de63a1b..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_TransitionImpl.cxx
 +++ /dev/null
-@@ -1,1318 +0,0 @@
+@@ -1,1315 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: OGLTrans_TransitionImpl.cxx,v $
-- * $Revision: 1.5 $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -1816,18 +1798,15 @@ deleted file mode 100644
 index 2aa0529..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_TransitionImpl.hxx
 +++ /dev/null
-@@ -1,509 +0,0 @@
+@@ -1,506 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: OGLTrans_TransitionImpl.hxx,v $
-- * $Revision: 1.5 $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -2331,18 +2310,15 @@ deleted file mode 100644
 index 01d513c..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_TransitionerImpl.cxx
 +++ /dev/null
-@@ -1,1487 +0,0 @@
+@@ -1,1484 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: OGLTrans_TransitionerImpl.cxx,v $
-- * $Revision: 1.6 $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -7487,19 +7463,15 @@ deleted file mode 100644
 index 6353b2d..0000000
 --- slideshow/source/engine/OGLTrans/makefile.mk
 +++ /dev/null
-@@ -1,84 +0,0 @@
+@@ -1,80 +0,0 @@
 -#*************************************************************************
 -#
 -# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 -# 
--# Copyright 2008 by Sun Microsystems, Inc.
+-# Copyright 2000, 2010 Oracle and/or its affiliates.
 -#
 -# OpenOffice.org - a multi-platform office productivity suite
 -#
--# $RCSfile: makefile.mk,v $
--#
--# $Revision: 1.5 $
--#
 -# This file is part of OpenOffice.org.
 -#
 -# OpenOffice.org is free software: you can redistribute it and/or modify
diff --git a/patches/dev300/writer-doc-comparison.diff b/patches/dev300/writer-doc-comparison.diff
index 23cc606..93c1751 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/writer-doc-comparison.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/writer-doc-comparison.diff
@@ -1,6 +1,6 @@
 Tzvetelinas gsoc project - writer document comparison
 
-From: Thorsten Behrens <thb@openoffice.org>
+From: Thorsten Behrens <tbehrens@novell.com>
 
 
 ---
@@ -38,6 +38,7 @@ From: Thorsten Behrens <thb@openoffice.org>
  sw/source/filter/html/css1atr.cxx                  |    3 
  sw/source/filter/html/htmlatr.cxx                  |    2 
  sw/source/filter/rtf/rtfatr.cxx                    |    3 
+ sw/source/filter/xml/xmlexp.cxx                    |    8 
  sw/source/ui/app/appopt.cxx                        |    1 
  sw/source/ui/app/docsh.cxx                         |    3 
  sw/source/ui/app/swmodul1.cxx                      |   40 +
@@ -57,7 +58,7 @@ From: Thorsten Behrens <thb@openoffice.org>
  xmloff/source/style/xmlbahdl.cxx                   |   42 +
  xmloff/source/style/xmlbahdl.hxx                   |   12 
  xmloff/source/text/txtprmap.cxx                    |    8 
- 52 files changed, 1876 insertions(+), 153 deletions(-)
+ 53 files changed, 1884 insertions(+), 153 deletions(-)
  create mode 100644 svx/inc/svx/rsiditem.hxx
 
 
@@ -2268,6 +2269,25 @@ index bbe9030..faeb5ed 100644
  
  /* RES_PARATR_LIST_ID */            0, // new
  /* RES_PARATR_LIST_LEVEL */         0, // new
+diff --git sw/source/filter/xml/xmlexp.cxx sw/source/filter/xml/xmlexp.cxx
+index f2ec2a7..17010e2 100644
+--- sw/source/filter/xml/xmlexp.cxx
++++ sw/source/filter/xml/xmlexp.cxx
+@@ -240,6 +240,14 @@ sal_uInt32 SwXMLExport::exportDoc( enum XMLTokenEnum eClass )
+     if( (getExportFlags() & (EXPORT_FONTDECLS|EXPORT_STYLES|
+                              EXPORT_MASTERSTYLES|EXPORT_CONTENT)) != 0 )
+     {
++        if( getDefaultVersion() == SvtSaveOptions::ODFVER_LATEST )
++        {
++            _GetNamespaceMap().Add(
++                GetXMLToken(XML_NP_OFFICE_EXT),
++                GetXMLToken(XML_N_OFFICE_EXT), 
++                XML_NAMESPACE_OFFICE_EXT);
++        }
++
+         GetTextParagraphExport()->SetBlockMode( bBlock );
+ 
+         const SfxPoolItem* pItem;
 diff --git sw/source/ui/app/appopt.cxx sw/source/ui/app/appopt.cxx
 index 1f178d4..e77bf2a 100644
 --- sw/source/ui/app/appopt.cxx
@@ -3015,7 +3035,7 @@ index 9c4e1c3..fbbbbeb 100644
  */
  class XMLStringPropHdl : public XMLPropertyHandler
 diff --git xmloff/source/text/txtprmap.cxx xmloff/source/text/txtprmap.cxx
-index e68469f..6a6e960 100644
+index e68469f..c7758d3 100644
 --- xmloff/source/text/txtprmap.cxx
 +++ xmloff/source/text/txtprmap.cxx
 @@ -149,6 +149,10 @@ XMLPropertyMapEntry aXMLParaPropMap[] =
@@ -3023,9 +3043,9 @@ index e68469f..6a6e960 100644
      // RES_CHRATR_WEIGHT
      MT_E( "CharWeight",		FO,		FONT_WEIGHT,		XML_TYPE_TEXT_WEIGHT, 0 ),
 +	// RES_CHRATR_RSID
-+	MT_E( "Rsid",		TEXT,		RSID,		XML_TYPE_HEX, 0 ),
++    { "Rsid", sizeof("Rsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_RSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
 +	// RES_PARATR_RSID
-+	MT_E( "ParRsid",	TEXT,		PARRSID,	XML_TYPE_HEX, 0 ),
++    { "ParRsid", sizeof("ParRsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_PARRSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
      // RES_CHRATR_WORDLINEMODE
      MT_E( "CharWordMode",	STYLE,	TEXT_UNDERLINE_MODE,		XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
      MT_E( "CharWordMode",   STYLE,  TEXT_OVERLINE_MODE,     XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
@@ -3034,9 +3054,9 @@ index e68469f..6a6e960 100644
      // RES_CHRATR_WEIGHT
      MT_E( "CharWeight",		FO,		FONT_WEIGHT,		XML_TYPE_TEXT_WEIGHT, 0 ),
 +	// RES_CHRATR_RSID
-+	MT_E( "Rsid",		TEXT,		RSID,		XML_TYPE_HEX, 0 ),
++    { "Rsid", sizeof("Rsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_RSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
 +	// RES_PARATR_RSID
-+	MT_E( "ParRsid",	TEXT,		PARRSID,	XML_TYPE_HEX, 0 ),
++    { "ParRsid", sizeof("ParRsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_PARRSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
      // RES_CHRATR_WORDLINEMODE
      MT_E( "CharWordMode",	STYLE,	TEXT_UNDERLINE_MODE,		XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
      MT_E( "CharWordMode",   STYLE,  TEXT_OVERLINE_MODE,     XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
diff --git a/src/easter/weimingkhoo.png b/src/easter/weimingkhoo.png
new file mode 100644
index 0000000..7f6533c
Binary files /dev/null and b/src/easter/weimingkhoo.png differ
diff --git a/src/go-oo-team.png b/src/go-oo-team.png
index 2c8eed6..2171cdd 100644
Binary files a/src/go-oo-team.png and b/src/go-oo-team.png differ
