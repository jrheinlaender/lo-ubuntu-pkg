From: Bjoern Michaelsen <bjoern.michaelsen@canonical.com>
Date: Sun, 16 Feb 2014 00:25:12 +0100
Subject: [PATCH] add missing postprocess deps

- these sometimes break a highly parallel build

Change-Id: Ia30041d2d2ce69900db0476313a0bf2baf6da7a5

---
 postprocess/CustomTarget_registry.mk | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/postprocess/CustomTarget_registry.mk b/postprocess/CustomTarget_registry.mk
--- a/postprocess/CustomTarget_registry.mk
+++ b/postprocess/CustomTarget_registry.mk
@@ -525,13 +525,16 @@ $(call gb_XcdTarget_get_target,Langpack-$(1).xcd) : \
 	$(call gb_CustomTarget_get_workdir,postprocess/registry)/Langpack-$(1).list
 
 $(call gb_CustomTarget_get_workdir,postprocess/registry)/Langpack-$(1).list : \
-	$(call gb_XcuLangpackTarget_get_target,Langpack-$(1).xcu)
+	$(call gb_XcuLangpackTarget_get_target,Langpack-$(1).xcu) \
+	| $(call gb_CustomTarget_get_workdir,postprocess/registry)/.dir
 
 $(call gb_XcdTarget_get_target,fcfg_langpack_$(1).xcd) : \
-	$(call gb_CustomTarget_get_workdir,postprocess/registry)/fcfg_langpack_$(1).list
+	$(call gb_CustomTarget_get_workdir,postprocess/registry)/fcfg_langpack_$(1).list \
+	| $(call gb_CustomTarget_get_workdir,postprocess/registry)/.dir
 
 $(call gb_CustomTarget_get_workdir,postprocess/registry)/fcfg_langpack_$(1).list : \
-	$(call gb_Configuration_get_target,fcfg_langpack)
+	$(call gb_Configuration_get_target,fcfg_langpack) \
+	| $(call gb_CustomTarget_get_workdir,postprocess/registry)/.dir
 
 $(call gb_XcdTarget_get_target,registry_$(1).xcd) : \
 	$(call gb_CustomTarget_get_workdir,postprocess/registry)/registry_$(1).list
@@ -541,7 +544,8 @@ $(call gb_CustomTarget_get_workdir,postprocess/registry)/registry_$(1).list : \
 	$(if $(filter DBCONNECTIVITY,$(BUILD_TYPE)),\
 		$(foreach driver,$(postprocess_DRIVERS),$(call gb_Configuration_get_target,$(driver))) \
 	) \
-	$(if $(filter TRUE,$(ENABLE_ONLINE_UPDATE)),$(call gb_Configuration_get_target,updchk))
+	$(if $(filter TRUE,$(ENABLE_ONLINE_UPDATE)),$(call gb_Configuration_get_target,updchk)) \
+	| $(call gb_CustomTarget_get_workdir,postprocess/registry)/.dir
 
 endef
 $(foreach lang,$(gb_Configuration_LANGS),$(eval $(call postprocess_lang_deps,$(lang))))
-- 
1.9.1

