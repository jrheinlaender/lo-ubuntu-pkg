From dc9560e271aeda7ebbd01de6794ade09c7b0152d Mon Sep 17 00:00:00 2001
From: Kohei Yoshida <kohei.yoshida@gmail.com>
Date: Tue, 14 Aug 2012 16:46:44 -0400
Subject: [PATCH] Resolves: fdo#56009 fdo#54695 Calculate positions of
 cell-anchored objects
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

on ods import

Since we no longer re-calc row heights on ods import, we need to do
this manually, in order to position cell-anchored objects correctly.
Previously we were getting this for free since the row height recalc
code path did it as part of it.

Signed-off-by: Noel Power <noel.power@suse.com>
(cherry picked from commit 89e34ef5e4ff5efc202656bd9a2122745fdc6530)

Change-Id: I8ab5dd1fe7cd8a45b7968e101c893b442d7ce132
Signed-off-by: Caol√°n McNamara <caolanm@redhat.com>
---
 sc/source/filter/xml/xmlimprt.cxx |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/sc/source/filter/xml/xmlimprt.cxx b/sc/source/filter/xml/xmlimprt.cxx
index 166cef9..6a67c6a 100644
--- a/sc/source/filter/xml/xmlimprt.cxx
+++ b/sc/source/filter/xml/xmlimprt.cxx
@@ -2929,8 +2929,11 @@ throw( ::com::sun::star::xml::sax::SAXException, ::com::sun::star::uno::RuntimeE
 
             SCTAB nTabCount = pDoc->GetTableCount();
             for (SCTAB nTab=0; nTab<nTabCount; ++nTab)
+            {
+                pDoc->SetDrawPageSize(nTab);
                 if (!pSheetData->IsSheetBlocked( nTab ))
                     pDoc->SetStreamValid( nTab, true );
+            }
         }
 
         aTables.FixupOLEs();
-- 
1.7.10.4

