Index: libreoffice-3.3.2/libreoffice-build/patches/dev300/lp-integration.diff
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ libreoffice-3.3.2/libreoffice-build/patches/dev300/lp-integration.diff	2011-03-22 15:24:45.000000000 +0100
@@ -0,0 +1,537 @@
+diff --git a/dbaccess/uiconfig/dbapp/menubar/menubar.xml b/dbaccess/uiconfig/dbapp/menubar/menubar.xml
+index a76fda5..59ca451 100644
+--- a/dbaccess/uiconfig/dbapp/menubar/menubar.xml
++++ b/dbaccess/uiconfig/dbapp/menubar/menubar.xml
+@@ -133,6 +133,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/dbaccess/uiconfig/dbquery/menubar/menubar.xml b/dbaccess/uiconfig/dbquery/menubar/menubar.xml
+index 2d6ec8d..dcce258 100644
+--- a/dbaccess/uiconfig/dbquery/menubar/menubar.xml
++++ b/dbaccess/uiconfig/dbquery/menubar/menubar.xml
+@@ -74,6 +74,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/dbaccess/uiconfig/dbrelation/menubar/menubar.xml b/dbaccess/uiconfig/dbrelation/menubar/menubar.xml
+index b7460a4..60047af 100644
+--- a/dbaccess/uiconfig/dbrelation/menubar/menubar.xml
++++ b/dbaccess/uiconfig/dbrelation/menubar/menubar.xml
+@@ -57,6 +57,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/dbaccess/uiconfig/dbtable/menubar/menubar.xml b/dbaccess/uiconfig/dbtable/menubar/menubar.xml
+index ede5eed..3730315 100644
+--- a/dbaccess/uiconfig/dbtable/menubar/menubar.xml
++++ b/dbaccess/uiconfig/dbtable/menubar/menubar.xml
+@@ -58,6 +58,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/dbaccess/uiconfig/dbtdata/menubar/menubar.xml b/dbaccess/uiconfig/dbtdata/menubar/menubar.xml
+index 79fe68a..b907c03 100644
+--- a/dbaccess/uiconfig/dbtdata/menubar/menubar.xml
++++ b/dbaccess/uiconfig/dbtdata/menubar/menubar.xml
+@@ -66,6 +66,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/reportdesign/uiconfig/dbreport/menubar/menubar.xml b/reportdesign/uiconfig/dbreport/menubar/menubar.xml
+index 9993288..05acb54 100644
+--- a/reportdesign/uiconfig/dbreport/menubar/menubar.xml
++++ b/reportdesign/uiconfig/dbreport/menubar/menubar.xml
+@@ -413,6 +413,10 @@
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:HelperDialog"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sd/uiconfig/sdraw/menubar/menubar.xml b/sd/uiconfig/sdraw/menubar/menubar.xml
+index 58e460f..52e79cb 100644
+--- a/sd/uiconfig/sdraw/menubar/menubar.xml
++++ b/sd/uiconfig/sdraw/menubar/menubar.xml
+@@ -323,6 +323,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sd/uiconfig/simpress/menubar/menubar.xml b/sd/uiconfig/simpress/menubar/menubar.xml
+index 4ae1665..1c8e976 100755
+--- a/sd/uiconfig/simpress/menubar/menubar.xml
++++ b/sd/uiconfig/simpress/menubar/menubar.xml
+@@ -297,6 +297,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/framework/inc/dispatch/launchpadinterceptor.hxx b/framework/inc/dispatch/launchpadinterceptor.hxx
+new file mode 100644
+index 0000000..3b3bf23
+--- /dev/null
++++ b/framework/inc/dispatch/launchpadinterceptor.hxx
+@@ -0,0 +1,19 @@
++/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
++
++// Copyright LGPL/MPL 2011 Canonical, Ltd.
++
++// MARKER(update_precomp.py): autogen include statement, do not remove
++#include "precompiled_framework.hxx"
++
++#include <com/sun/star/frame/XDispatchProviderInterception.hpp>
++
++#ifndef __FRAMEWORK_DISPATCH_LAUNCHPADINTERCEPTOR_HXX_
++#define __FRAMEWORK_DISPATCH_LAUNCHPADINTERCEPTOR_HXX_
++
++namespace com { namespace canonical { namespace launchpadintegration {
++    void registerLaunchpadInterceptor(const ::com::sun::star::uno::Reference< ::com::sun::star::frame::XDispatchProviderInterception >& xInterception);
++}}}
++
++#endif
++
++/* vim:set shiftwidth=4 softtabstop=4 expandtab: */
+diff --git a/framework/source/dispatch/launchpadinterceptor.cxx b/framework/source/dispatch/launchpadinterceptor.cxx
+new file mode 100644
+index 0000000..889e454
+--- /dev/null
++++ b/framework/source/dispatch/launchpadinterceptor.cxx
+@@ -0,0 +1,188 @@
++/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
++
++// Copyright LGPL/MPL 2011 Canonical, Ltd.
++
++// MARKER(update_precomp.py): autogen include statement, do not remove
++#include "precompiled_framework.hxx"
++
++#include <com/sun/star/frame/XDispatch.hpp>
++#include <com/sun/star/frame/XDispatchProviderInterception.hpp>
++#include <com/sun/star/frame/XDispatchProviderInterceptor.hpp>
++#include <com/sun/star/system/SystemShellExecuteFlags.hpp>
++#include <com/sun/star/system/XSystemShellExecute.hpp>
++#include <comphelper/processfactory.hxx>
++#include <comphelper/stlunosequence.hxx>
++#include <cppuhelper/implbase1.hxx>
++#include <cppuhelper/implbase2.hxx>
++#include <dispatch/launchpadinterceptor.hxx>
++#include <osl/diagnose.h>
++
++#include <algorithm>
++
++namespace css = com::sun::star;
++
++using comphelper::getProcessServiceFactory;
++using comphelper::stl_begin;
++using comphelper::stl_end;
++using css::beans::PropertyValue;
++using css::frame::DispatchDescriptor;
++using css::frame::FeatureStateEvent;
++using css::frame::XDispatch;
++using css::frame::XDispatchProvider;
++using css::frame::XDispatchProviderInterception;
++using css::frame::XDispatchProviderInterceptor;
++using css::frame::XStatusListener;
++using css::system::XSystemShellExecute;
++using css::uno::Any;
++using css::uno::makeAny;
++using css::uno::Reference;
++using css::uno::RuntimeException;
++using css::uno::Sequence;
++using css::util::URL;
++using rtl::OUString;
++
++namespace com { namespace canonical { namespace launchpadintegration
++{
++    class LaunchpadDispatch : public ::cppu::WeakImplHelper1< XDispatch >
++    {
++        public:
++            virtual void SAL_CALL dispatch(const URL& aUrl, const Sequence< PropertyValue >& aArgs) throw (RuntimeException);
++            virtual void SAL_CALL addStatusListener(const Reference< XStatusListener >&, const URL&) throw (RuntimeException);
++            virtual void SAL_CALL removeStatusListener(const Reference< XStatusListener >&, const URL&) throw (RuntimeException)
++                {};
++            static const OUString our_sHelpOnline;
++            static const OUString our_sHelpOnlineLabel;
++            static const OUString our_sHelpTranslate;
++            static const OUString our_sHelpTranslateLabel;
++            static const OUString our_sProblemReport;
++            static const OUString our_sProblemReportLabel;
++        private:
++            void execute(const OUString& sCommand, const OUString& sParams);
++            static const OUString our_sSystemShellExecuteName;
++    };
++
++    class LaunchpadInterceptor :
++        public ::cppu::WeakImplHelper1< XDispatchProviderInterceptor >
++    {
++        public:
++            virtual Reference< XDispatch > SAL_CALL queryDispatch(const URL& aUrl, const OUString& sTargetFrameName, sal_Int32 nSearchFlags) throw (RuntimeException);
++            virtual Sequence< Reference< XDispatch > > SAL_CALL queryDispatches(const Sequence< DispatchDescriptor >& lDescriptor) throw (RuntimeException);
++            virtual Reference< XDispatchProvider > SAL_CALL getMasterDispatchProvider() throw(RuntimeException)
++                { return m_xMaster; };
++            virtual Reference< XDispatchProvider > SAL_CALL getSlaveDispatchProvider() throw(RuntimeException)
++                { return m_xSlave; };
++            virtual void SAL_CALL setMasterDispatchProvider(const Reference< XDispatchProvider >& xMaster) throw(RuntimeException)
++                { m_xMaster = xMaster; };
++            virtual void SAL_CALL setSlaveDispatchProvider(const Reference< XDispatchProvider >& xSlave) throw(RuntimeException)
++                { m_xSlave = xSlave; };
++        private:
++            Reference< XDispatchProvider > m_xMaster;
++            Reference< XDispatchProvider > m_xSlave;
++            static const OUString our_sProtocol;
++    };
++
++    struct QueryTransformer
++    {
++        LaunchpadInterceptor* const m_pInterceptor;
++        QueryTransformer(LaunchpadInterceptor* pInterceptor) : m_pInterceptor(pInterceptor) {};
++        Reference< XDispatch > operator()(const DispatchDescriptor& rDescriptor)
++        {
++            return m_pInterceptor->queryDispatch(rDescriptor.FeatureURL, OUString(), 0);
++        };
++    };
++}}}
++
++using namespace com::canonical::launchpadintegration;
++
++
++const OUString LaunchpadDispatch::our_sHelpOnline = OUString(RTL_CONSTASCII_USTRINGPARAM(".launchpad:HelpOnline"));
++const OUString LaunchpadDispatch::our_sHelpOnlineLabel = OUString(RTL_CONSTASCII_USTRINGPARAM("Get Help Online"));
++const OUString LaunchpadDispatch::our_sHelpTranslate = OUString(RTL_CONSTASCII_USTRINGPARAM(".launchpad:HelpTranslate"));
++const OUString LaunchpadDispatch::our_sHelpTranslateLabel = OUString(RTL_CONSTASCII_USTRINGPARAM("Translate This Application"));
++const OUString LaunchpadDispatch::our_sProblemReport = OUString(RTL_CONSTASCII_USTRINGPARAM(".launchpad:HelpReportProblem"));
++const OUString LaunchpadDispatch::our_sProblemReportLabel = OUString(RTL_CONSTASCII_USTRINGPARAM("Report a Problem"));
++const OUString LaunchpadDispatch::our_sSystemShellExecuteName = OUString(RTL_CONSTASCII_USTRINGPARAM("com.sun.star.system.SystemShellExecute"));
++
++const OUString LaunchpadInterceptor::our_sProtocol = OUString(RTL_CONSTASCII_USTRINGPARAM(".launchpad:"));
++
++Reference< XDispatch > SAL_CALL LaunchpadInterceptor::queryDispatch(const URL& aUrl, const OUString& sTargetFrameName, sal_Int32 nSearchFlags)
++    throw (RuntimeException)
++{
++    OSL_TRACE("queryDispatch: %s", OUStringToOString(aUrl.Complete, RTL_TEXTENCODING_UTF8).getStr());
++    if(aUrl.Protocol.equals(our_sProtocol))
++    {
++        if(aUrl.Complete.equals(LaunchpadDispatch::our_sProblemReport)
++            || aUrl.Complete.equals(LaunchpadDispatch::our_sHelpTranslate)
++            || aUrl.Complete.equals(LaunchpadDispatch::our_sHelpOnline))
++            return Reference< XDispatch >(new LaunchpadDispatch());
++    }
++    return m_xSlave->queryDispatch(aUrl, sTargetFrameName, nSearchFlags);
++};
++
++Sequence< Reference< XDispatch > > LaunchpadInterceptor::queryDispatches(const Sequence< DispatchDescriptor >& lDescriptor)
++    throw (RuntimeException)
++{
++    Sequence< Reference< XDispatch > > vResult(lDescriptor.getLength());
++    ::std::transform(
++        stl_begin(lDescriptor),
++        stl_end(lDescriptor),
++        stl_begin(vResult),
++        QueryTransformer(this));
++    return vResult;
++}
++
++void LaunchpadDispatch::execute(const OUString& sCommand, const OUString& sParams)
++{
++    try
++    {
++        Reference< XSystemShellExecute > xSystemShell(getProcessServiceFactory()->createInstance(our_sSystemShellExecuteName), css::uno::UNO_QUERY);
++        if(xSystemShell.is())
++            xSystemShell->execute(
++                sCommand,
++                sParams,
++                42); // 42 is a very dark magic to keep the parameters unquoted
++
++    }
++    catch (const ::com::sun::star::uno::Exception &)
++        { }
++}
++
++void LaunchpadDispatch::dispatch(const URL& aUrl, const Sequence< PropertyValue >&)
++    throw (RuntimeException)
++{
++    if(aUrl.Complete.equals(our_sProblemReport))
++        execute(OUString(RTL_CONSTASCII_USTRINGPARAM("/bin/sh")), OUString(RTL_CONSTASCII_USTRINGPARAM("-c \"/usr/bin/launchpad-integration -P libreoffice-core -b&\"")));
++    else if (aUrl.Complete.equals(our_sHelpTranslate))
++        execute(OUString(RTL_CONSTASCII_USTRINGPARAM("/bin/sh")), OUString(RTL_CONSTASCII_USTRINGPARAM("-c \"/usr/bin/launchpad-integration -P libreoffice-core -t&\"")));
++    else if (aUrl.Complete.equals(our_sHelpOnline))
++        execute(OUString(RTL_CONSTASCII_USTRINGPARAM("/usr/bin/gnome-open")), OUString(RTL_CONSTASCII_USTRINGPARAM("https://answers.launchpad.net/ubuntu/natty/+source/libreoffice/+gethelp")));
++    else
++        throw RuntimeException();
++}
++
++void LaunchpadDispatch::addStatusListener(const Reference< XStatusListener >& xListener, const URL& aUrl)
++    throw (RuntimeException)
++{
++    OUString aLabel;
++    if(aUrl.Complete.equals(our_sProblemReport))
++        aLabel = our_sProblemReportLabel;
++    else if(aUrl.Complete.equals(our_sHelpTranslate))
++        aLabel = our_sHelpTranslateLabel;
++    else if(aUrl.Complete.equals(our_sHelpOnline))
++        aLabel = our_sHelpOnlineLabel;
++    FeatureStateEvent aEvent(
++        static_cast<cppu::OWeakObject*>(this),
++        aUrl,
++        aLabel,
++        true,
++        false,
++        makeAny(aLabel));
++    xListener->statusChanged(aEvent);
++}
++
++void ::com::canonical::launchpadintegration::registerLaunchpadInterceptor(com::sun::star::uno::Reference<com::sun::star::frame::XDispatchProviderInterception> const& xInterception)
++{
++    xInterception->registerDispatchProviderInterceptor(Reference< XDispatchProviderInterceptor >(new LaunchpadInterceptor()));
++}
++
++/* vim:set shiftwidth=4 softtabstop=4 expandtab: */
+diff --git a/framework/source/dispatch/makefile.mk b/framework/source/dispatch/makefile.mk
+index b969d71..7e7c78a 100644
+--- a/framework/source/dispatch/makefile.mk
++++ b/framework/source/dispatch/makefile.mk
+@@ -48,15 +48,16 @@ SLOFILES=\
+     $(SLO)$/helpagentdispatcher.obj             \
+     $(SLO)$/interaction.obj                     \
+     $(SLO)$/interceptionhelper.obj              \
++    $(SLO)$/launchpadinterceptor.obj            \
+     $(SLO)$/loaddispatcher.obj                  \
+     $(SLO)$/mailtodispatcher.obj                \
+     $(SLO)$/menudispatcher.obj                  \
+     $(SLO)$/oxt_handler.obj                     \
+     $(SLO)$/popupmenudispatcher.obj             \
+     $(SLO)$/servicehandler.obj                  \
+-    $(SLO)$/systemexec.obj		                \
++    $(SLO)$/startmoduledispatcher.obj           \
++    $(SLO)$/systemexec.obj		        \
+     $(SLO)$/windowcommanddispatch.obj           \
+-    $(SLO)$/startmoduledispatcher.obj
+ 
+ # --- Targets ------------------------------------------------------
+ 
+diff --git a/framework/source/services/desktop.cxx b/framework/source/services/desktop.cxx
+index d59b361..5660d3b 100644
+--- a/framework/source/services/desktop.cxx
++++ b/framework/source/services/desktop.cxx
+@@ -97,6 +97,9 @@
+ #endif
+ #include <comphelper/extract.hxx>
+ 
++
++#include <dispatch/launchpadinterceptor.hxx>
++
+ //_________________________________________________________________________________________________________________
+ //	namespace
+ //_________________________________________________________________________________________________________________
+@@ -191,6 +194,7 @@ DEFINE_INIT_SERVICE                     (   Desktop,
+                                                 // So it's easiear to destroy it.
+                                                 InterceptionHelper* pInterceptionHelper = new InterceptionHelper( this, xDispatchProvider );
+                                                 m_xDispatchHelper = css::uno::Reference< css::frame::XDispatchProvider >( static_cast< ::cppu::OWeakObject* >(pInterceptionHelper), css::uno::UNO_QUERY );
++                                                ::com::canonical::launchpadintegration::registerLaunchpadInterceptor(css::uno::Reference< css::frame::XDispatchProviderInterception>(m_xDispatchHelper, css::uno::UNO_QUERY));
+ 
+                                                 ::rtl::OUStringBuffer sUntitledPrefix (256);
+                                                 sUntitledPrefix.append      (::rtl::OUString( String( FwkResId( STR_UNTITLED_DOCUMENT ))));
+diff --git a/framework/source/services/frame.cxx b/framework/source/services/frame.cxx
+index 03f1f36..40690fd 100644
+--- a/framework/source/services/frame.cxx
++++ b/framework/source/services/frame.cxx
+@@ -107,6 +107,7 @@
+ 
+ #include <vcl/menu.hxx>
+ 
++#include <dispatch/launchpadinterceptor.hxx>
+ //_________________________________________________________________________________________________________________
+ //	namespace
+ //_________________________________________________________________________________________________________________
+@@ -212,6 +213,8 @@ DEFINE_INIT_SERVICE                 (   Frame,
+                                             InterceptionHelper* pInterceptionHelper = new InterceptionHelper( this, xDispatchProvider );
+                                             m_xDispatchHelper = css::uno::Reference< css::frame::XDispatchProvider >( static_cast< ::cppu::OWeakObject* >(pInterceptionHelper), css::uno::UNO_QUERY );
+ 
++                                            ::com::canonical::launchpadintegration::registerLaunchpadInterceptor(css::uno::Reference<css::frame::XDispatchProviderInterception>(m_xDispatchHelper, css::uno::UNO_QUERY));
++
+                                             //-------------------------------------------------------------------------------------------------------------
+                                             // Initialize a new XFrames-helper-object to handle XIndexAccess and XElementAccess.
+                                             // We hold member as reference ... not as pointer too!
+diff --git a/framework/uiconfig/startmodule/menubar/menubar.xml b/framework/uiconfig/startmodule/menubar/menubar.xml
+index 5ac4c3e..10e5624 100644
+--- a/framework/uiconfig/startmodule/menubar/menubar.xml
++++ b/framework/uiconfig/startmodule/menubar/menubar.xml
+@@ -74,6 +74,10 @@
+             <menu:menuitem menu:id=".uno:HelpIndex"/>
+             <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+             <menu:menuseparator/>
++            <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++            <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++            <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++            <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowLicense"/>
+             <menu:menuseparator/>
+             <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/framework/util/makefile.mk b/framework/util/makefile.mk
+index 78c680f..466bbce 100644
+--- a/framework/util/makefile.mk
++++ b/framework/util/makefile.mk
+@@ -273,6 +273,7 @@ SHL4OBJS=       \
+                 $(SLO)$/jobresult.obj               \
+                 $(SLO)$/joburl.obj                  \
+                 $(SLO)$/keymapping.obj              \
++                $(SLO)$/launchpadinterceptor.obj      \
+                 $(SLO)$/langselectionstatusbarcontroller.obj \
+                 $(SLO)$/layoutmanager.obj           \
+                 $(SLO)$/loaddispatcher.obj          \
+diff --git a/starmath/uiconfig/smath/menubar/menubar.xml b/starmath/uiconfig/smath/menubar/menubar.xml
+index 5b01e9b..22fd23e 100644
+--- a/starmath/uiconfig/smath/menubar/menubar.xml
++++ b/starmath/uiconfig/smath/menubar/menubar.xml
+@@ -112,6 +112,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sw/uiconfig/sglobal/menubar/menubar.xml b/sw/uiconfig/sglobal/menubar/menubar.xml
+index 8cd46b6..e6abd21 100644
+--- a/sw/uiconfig/sglobal/menubar/menubar.xml
++++ b/sw/uiconfig/sglobal/menubar/menubar.xml
+@@ -452,6 +452,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sw/uiconfig/sweb/menubar/menubar.xml b/sw/uiconfig/sweb/menubar/menubar.xml
+index fa417a6..0f7dcce 100644
+--- a/sw/uiconfig/sweb/menubar/menubar.xml
++++ b/sw/uiconfig/sweb/menubar/menubar.xml
+@@ -381,6 +381,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sw/uiconfig/swform/menubar/menubar.xml b/sw/uiconfig/swform/menubar/menubar.xml
+index cc8b013..2df85de 100644
+--- a/sw/uiconfig/swform/menubar/menubar.xml
++++ b/sw/uiconfig/swform/menubar/menubar.xml
+@@ -447,6 +447,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sw/uiconfig/swreport/menubar/menubar.xml b/sw/uiconfig/swreport/menubar/menubar.xml
+index cc8b013..2df85de 100644
+--- a/sw/uiconfig/swreport/menubar/menubar.xml
++++ b/sw/uiconfig/swreport/menubar/menubar.xml
+@@ -447,6 +447,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sw/uiconfig/swriter/menubar/menubar.xml b/sw/uiconfig/swriter/menubar/menubar.xml
+index 58422d9..245234e 100644
+--- a/sw/uiconfig/swriter/menubar/menubar.xml
++++ b/sw/uiconfig/swriter/menubar/menubar.xml
+@@ -456,6 +456,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
+diff --git a/sw/uiconfig/swxform/menubar/menubar.xml b/sw/uiconfig/swxform/menubar/menubar.xml
+index 32df447..78f8bc2 100644
+--- a/sw/uiconfig/swxform/menubar/menubar.xml
++++ b/sw/uiconfig/swxform/menubar/menubar.xml
+@@ -448,6 +448,10 @@
+       <menu:menuitem menu:id=".uno:HelpIndex"/>
+       <menu:menuitem menu:id=".uno:ExtendedHelp"/>
+       <menu:menuseparator/>
++      <menu:menuitem menu:id=".launchpad:HelpOnline"/>
++      <menu:menuitem menu:id=".launchpad:HelpTranslate"/>
++      <menu:menuitem menu:id=".launchpad:HelpReportProblem"/>
++      <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowLicense"/>
+       <menu:menuseparator/>
+       <menu:menuitem menu:id=".uno:ShowCredits"/>
Index: libreoffice-3.3.2/libreoffice-build/patches/dev300/apply
===================================================================
--- libreoffice-3.3.2.orig/libreoffice-build/patches/dev300/apply	2011-03-22 15:26:10.761327790 +0100
+++ libreoffice-3.3.2/libreoffice-build/patches/dev300/apply	2011-03-22 15:26:51.781327780 +0100
@@ -1551,9 +1551,7 @@
 SectionOwner => ccheney
 
 ubuntu-palette.diff
-# FIXME: update for LO
-#ubuntu-lpi-help-translate.diff, i#64895, mklose
-#ubuntu-lpi-bugs.diff, i#64895, mklose
+lp-integration.diff
 ubuntu-sparc-hack.diff, mklose
 human-icons-add2.diff
 ubuntu-no-stack-protector.diff, doko
