From: Bjoern Michaelsen <bjoern.michaelsen@canonical.com>
Date: Tue, 12 Apr 2016 23:23:51 +0200
Subject: [PATCH] lp#1560328: clear cache before disposing rest of VCL

Change-Id: Iac325cf934953c61cb4dbbb67cfbab1777dc45cc

---
 vcl/source/app/svmain.cxx | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/vcl/source/app/svmain.cxx b/vcl/source/app/svmain.cxx
--- a/vcl/source/app/svmain.cxx
+++ b/vcl/source/app/svmain.cxx
@@ -335,6 +335,9 @@ VCLUnoWrapperDeleter::disposing(lang::EventObject const& /* rSource */)
 void DeInitVCL()
 {
     ImplSVData* pSVData = ImplGetSVData();
+    // lp#1560328: clear cache before disposing rest of VCL
+    if(pSVData->mpBlendFrameCache)
+        pSVData->mpBlendFrameCache->m_aLastResult.Clear();
     pSVData->mbDeInit = true;
 
     vcl::DeleteOnDeinitBase::ImplDeleteOnDeInit();
-- 
2.5.0

