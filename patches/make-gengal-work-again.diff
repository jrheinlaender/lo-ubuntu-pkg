--- /dev/null	2011-08-03 18:17:49.619073942 +0200
+++ libreoffice-3.4.2/libreoffice-build/patches/hotfixes/make-gengal-work-again.diff	2011-08-12 20:45:59.000000000 +0200
@@ -0,0 +1,162 @@
+--- svx/source/gengal/makefile.mk-old	2011-08-12 20:08:29.000000000 +0200
++++ svx/source/gengal/makefile.mk	2011-08-12 20:09:00.000000000 +0200
+@@ -37,7 +37,6 @@
+ # --- Settings -----------------------------------------------------
+ 
+ .INCLUDE :  settings.mk
+-.INCLUDE :  $(PRJ)$/util$/makefile.pmk
+ 
+ # --- Files --------------------------------------------------------
+ 
+@@ -45,6 +44,8 @@
+ 
+ OBJFILES=	$(OBJ)$/gengal.obj
+ 
++CFLAGS += -I$(PRJ)/inc/svx
++
+ .IF "$(GUI)"=="WNT" || "$(GUI)"=="OS2"
+ APP1TARGET= $(TARGET)
+ .ELSE			# .IF "$(GUI)"=="WNT" || "$(GUI)"=="OS2"
+--- svx/source/gengal/gengal.cxx-old	2011-08-12 20:12:31.000000000 +0200
++++ svx/source/gengal/gengal.cxx	2011-08-12 20:14:09.000000000 +0200
+@@ -101,7 +101,7 @@
+ static void createTheme( rtl::OUString aThemeName,
+                          rtl::OUString aGalleryURL,
+                          rtl::OUString aDestDir,
+-                         UINT32 nNumFrom,
++                         sal_uInt32 nNumFrom,
+                          FileNameList &rFiles )
+ {
+     Gallery * pGallery( createGallery( aGalleryURL ) );
+@@ -279,10 +279,10 @@
+     bool bHelp = false;
+     rtl::OUString aPath, aDestDir;
+     rtl::OUString aName(RTL_CONSTASCII_USTRINGPARAM("Default name"));
+-    UINT32 nNumFrom = 0;
++    sal_uInt32 nNumFrom = 0;
+     FileNameList aFiles;
+ 
+-    for( USHORT i = 0; i < GetCommandLineParamCount(); i++ )
++    for( short i = 0; i < GetCommandLineParamCount(); i++ )
+     {
+         rtl::OUString aParam = GetCommandLineParam( i );
+ 
+--- /dev/null	2011-08-03 18:17:49.619073942 +0200
++++ svx/source/gengal/gengalrc.in	2011-08-12 20:16:21.000000000 +0200
+@@ -0,0 +1,12 @@
++OOO_INSTALL_PREFIX_URL=file://${OOO_INSTALL_PREFIX}
++OOO_BASIS_URL=${OOO_INSTALL_PREFIX_URL}/basis-link
++OOO_BASIS_BIN_URL=${OOO_BASIS_URL}/program
++OOO_URE_URL=${OOO_BASIS_URL}/ure-link
++#
++#CFG_INIFILE=${OOO_BASIS_BIN_URL}/configmgrrc
++#BaseInstallation=${OOO_BASIS_URL}
++BRAND_BASE_DIR=${OOO_INSTALL_PREFIX_URL}
++OOO_BASE_DIR=${OOO_BASIS_URL}
++#
++UNO_TYPES=${OOO_URE_URL}/share/misc/types.rdb ${OOO_BASIS_BIN_URL}/offapi.rdb
++UNO_SERVICES=${OOO_URE_URL}/share/misc/services.rdb ${OOO_BASIS_BIN_URL}/services.rdb
+--- /dev/null	2011-08-03 18:17:49.619073942 +0200
++++ svx/source/gengal/gengal.sh	2011-08-12 20:16:25.000000000 +0200
+@@ -0,0 +1,101 @@
++#!/bin/sh
++#*************************************************************************
++#
++# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
++# 
++# Copyright 2000, 2010 Oracle and/or its affiliates.
++#
++# OpenOffice.org - a multi-platform office productivity suite
++#
++# This file is part of OpenOffice.org.
++#
++# OpenOffice.org is free software: you can redistribute it and/or modify
++# it under the terms of the GNU Lesser General Public License version 3
++# only, as published by the Free Software Foundation.
++#
++# OpenOffice.org is distributed in the hope that it will be useful,
++# but WITHOUT ANY WARRANTY; without even the implied warranty of
++# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
++# GNU Lesser General Public License version 3 for more details
++# (a copy is included in the LICENSE file that accompanied this code).
++#
++# You should have received a copy of the GNU Lesser General Public License
++# version 3 along with OpenOffice.org.  If not, see
++# <http://www.openoffice.org/license.html>
++# for a copy of the LGPLv3 License.
++#
++#*************************************************************************
++
++# enable file locking
++SAL_ENABLE_FILE_LOCKING=1
++export SAL_ENABLE_FILE_LOCKING
++
++# resolve installation directory
++sd_cwd="`pwd`"
++if [ -h "$0" ] ; then
++    sd_basename=`basename "$0"`
++     sd_script=`ls -l "$0" | sed "s/.*${sd_basename} -> //g"` 
++    cd "`dirname "$0"`"
++    cd "`dirname "$sd_script"`"
++else
++    cd "`dirname "$0"`"
++fi
++
++sd_prog="`pwd`"
++
++cd ..
++sd_binary=`basename "$0"`".bin"
++sd_inst="`pwd`"
++
++# change back directory
++cd "$sd_cwd"
++
++# check if all required patches are installed
++if [ -x "$sd_prog/sopatchlevel.sh" ]; then
++    "$sd_prog/sopatchlevel.sh"
++    if [ $? -eq 1 ]; then
++        exit 0
++    fi
++fi
++
++# set search path for shared libraries
++sd_platform=`uname -s`
++case $sd_platform in
++  AIX)
++    LIBPATH=${sd_prog}${LIBPATH+:${LIBPATH}}
++    export LIBPATH
++    ;;
++
++  Darwin)
++    DYLD_LIBRARY_PATH=${sd_prog}${DYLD_LIBRARY_PATH:+:${DYLD_LIBRARY_PATH}}
++    export DYLD_LIBRARY_PATH
++    ;;
++
++  HP-UX)
++    SHLIB_PATH=${sd_prog}:/usr/openwin/lib${SHLIB_PATH:+:${SHLIB_PATH}}
++    export SHLIB_PATH
++    ;;
++
++  *)
++    LD_LIBRARY_PATH=${sd_prog}${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}
++    export LD_LIBRARY_PATH
++    ;;
++esac
++
++# misc. environment variables
++unset XENVIRONMENT
++
++# set path so that other apps can be started just by name
++PATH="$sd_prog":$PATH
++export PATH
++
++OOO_INSTALL_PREFIX=${OOO_INSTALL_PREFIX-$sd_prog/../..}
++if ! test -e $OOO_INSTALL_PREFIX/basis-link; then
++    # Hack for vanilla OOo binaries' split install layout
++    OOO_INSTALL_PREFIX=$OOO_INSTALL_PREFIX/../openoffice.org3
++fi
++
++export OOO_INSTALL_PREFIX
++
++# execute binary
++exec "$sd_prog/$sd_binary" "$@"
