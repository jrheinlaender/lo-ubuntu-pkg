From: Debian LibreOffice Maintainers <debian-openoffice@lists.debian.org>
Date: Mon, 8 Aug 2016 16:42:03 +0200
Subject: [PATCH] split-evoab.diff

---
 postprocess/CustomTarget_registry.mk |  5 +++--
 scp2/InstallModule_gnome.mk          |  1 +
 scp2/source/gnome/file_gnome.scp     | 10 ++++++++++
 scp2/source/gnome/module_gnome.scp   |  3 +++
 4 files changed, 17 insertions(+), 2 deletions(-)

diff --git a/postprocess/CustomTarget_registry.mk b/postprocess/CustomTarget_registry.mk
--- a/postprocess/CustomTarget_registry.mk
+++ b/postprocess/CustomTarget_registry.mk
@@ -329,8 +329,9 @@ ifneq ($(WITH_WEBDAV),)
 postprocess_FILES_main += $(postprocess_MOD)/org/openoffice/ucb/Configuration-webdav.xcu
 endif
 ifeq ($(ENABLE_EVOAB2),TRUE)
-postprocess_FILES_main += $(call gb_XcuModuleTarget_get_target,connectivity/registry/evoab2)/org/openoffice/Office/DataAccess/Drivers-evoab2.xcu
-postprocess_FILES_main += $(postprocess_MOD)/org/openoffice/Office/DataAccess-evoab2.xcu
+postprocess_XCDS += evoab.xcd
+postprocess_FILES_evoab += $(call gb_XcuModuleTarget_get_target,connectivity/registry/evoab2)/org/openoffice/Office/DataAccess/Drivers-evoab2.xcu
+postprocess_FILES_evoab += $(postprocess_MOD)/org/openoffice/Office/DataAccess-evoab2.xcu
 postprocess_DRIVERS += evoab
 endif
 ifeq ($(ENABLE_JAVA),TRUE)
diff --git a/scp2/InstallModule_gnome.mk b/scp2/InstallModule_gnome.mk
--- a/scp2/InstallModule_gnome.mk
+++ b/scp2/InstallModule_gnome.mk
@@ -12,6 +12,7 @@ $(eval $(call gb_InstallModule_InstallModule,scp2/gnome))
 $(eval $(call gb_InstallModule_use_auto_install_libs,scp2/gnome,gnome))
 
 $(eval $(call gb_InstallModule_define_if_set,scp2/gnome,\
+	ENABLE_EVOAB2 \
     ENABLE_GTK \
 ))
 
diff --git a/scp2/source/gnome/file_gnome.scp b/scp2/source/gnome/file_gnome.scp
--- a/scp2/source/gnome/file_gnome.scp
+++ b/scp2/source/gnome/file_gnome.scp
@@ -26,3 +26,13 @@ File gid_File_Share_Registry_Gnome_Xcd
     Name = "gnome.xcd";
 End
 #endif
+
+#ifdef ENABLE_EVOAB2
+File gid_File_Share_Registry_Evoab_Xcd
+    TXT_FILE_BODY;
+    Styles = (PACKED);
+    Dir = gid_Brand_Dir_Share_Registry;
+    Name = "evoab.xcd";
+End
+#endif
+
diff --git a/scp2/source/gnome/module_gnome.scp b/scp2/source/gnome/module_gnome.scp
--- a/scp2/source/gnome/module_gnome.scp
+++ b/scp2/source/gnome/module_gnome.scp
@@ -31,6 +31,9 @@ Module gid_Module_Optional_Gnome
 #if ENABLE_GIO
       gid_File_Share_Registry_Gnome_Xcd,
 #endif
+#ifdef ENABLE_EVOAB2
+     gid_File_Share_Registry_Evoab_Xcd,
+#endif
       gid_File_Bin_Gnome_Open_Url
     );
 End
-- 
2.7.4

