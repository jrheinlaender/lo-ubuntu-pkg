diff --git a/patches/dev300/apply b/patches/dev300/apply
index 7281f35..f018979 100644
--- openoffice.org-3.3.0/ooo-build-4fff9df877047fd183123e3bbe50fb91b80eb5f6//patches/dev300/apply
+++ openoffice.org-3.3.0/ooo-build-4fff9df877047fd183123e3bbe50fb91b80eb5f6//patches/dev300/apply
@@ -25,7 +25,7 @@ LinuxCommon : Common, Defaults, TangoIcons, FontConfigTemporaryHacks, \
 	      FedoraLinuxOnlyFixes, LinuxOnly, SystemBits, \
 	      msaccess, OpenGLTransitions, \
 	      Fpickers, Mono, AddressBooks, QuickStarter, KDE4, Netbook, \
-	      GlobalNSPluginSupport
+	      GlobalNSPluginSupport, SystemBitsWithSTLport
 MacOSXCommon : Common, Defaults, TangoIcons, SystemBits
 Win32Common : Common, Defaults, TangoIcons, \
 	      Win32Only, NotDebian, BuildFixWin32
@@ -36,8 +36,8 @@ Experimental: VBAUntested, ArkOnlyExperimental, \
 	      UnitBootstrap, RadioButtons, UnstableLibwpd, WWInProgress, \
 	      KDE4Experimental, MinGW, CalcExperimental, \
 	      OOXMLExportExperimental, CrossWin32Patches, AutoLayout, \
-	      WriterNavigation, SystemGraphiteWithSTLport, \
-	      HPPA, AXP, Speed, SystemMySQLWithSTLport
+	      WriterNavigation \
+	      HPPA, AXP, Speed
 DebianLooseSections: DebianBaseNoHelpContent
 # Optional sections
 Optional : LiberationFontsOnWindows, NovellOnlyExtensionFixes, Win32OnlyExtensionFixes, Linux32OnlyExtensionFixes
@@ -3219,8 +3219,9 @@ system-lpsolve-link-with-colamd.diff, rengelha
 # it doesn't hurt if we force it not to work on Windows, either.
 win32-dont-attempt-restart.diff, n#524250, tml
 
-[ SystemGraphiteWithSTLport ]
+[ SystemBitsWithSTLport ]
 fixup-graphite-layout-stl-type.diff, i#113563, cmc
+system-cppunit-with-stlport-ooo.diff, i#113503, cmc
 
 [ GnomeSessionManagement ]
 gnome-screen-saver.diff, i#106372, cmc
diff --git a/patches/dev300/system-cppunit-with-stlport-ooo.diff b/patches/dev300/system-cppunit-with-stlport-ooo.diff
new file mode 100644
index 0000000..8f038df
--- /dev/null
+++ openoffice.org-3.3.0/ooo-build-4fff9df877047fd183123e3bbe50fb91b80eb5f6//patches/dev300/system-cppunit-with-stlport-ooo.diff
@@ -0,0 +1,1066 @@
+
+# HG changeset patch
+# User Caol√°n McNamara <cmc@openoffice.org>
+# Date 1280826067 -3600
+# Node ID a6913c9677c236d0c6e051ef664a91c7f8d22021
+# Parent  a1a3b75faa8a55b23716fd5cb29cfcf4f4729e9d
+cmcfixes77: #i113503# system non-stlport cppunit with OOo stlport
+
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/basictest.cxx
+--- basebmp/test/basictest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/basictest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,10 +27,12 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
+ #include "cppunit/plugin/TestPlugIn.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/point/b2ipoint.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/bmpmasktest.cxx
+--- basebmp/test/bmpmasktest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/bmpmasktest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/range/b2irange.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/bmptest.cxx
+--- basebmp/test/bmptest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/bmptest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/range/b2irange.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/cliptest.cxx
+--- basebmp/test/cliptest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/cliptest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/point/b2ipoint.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/filltest.cxx
+--- basebmp/test/filltest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/filltest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/range/b2drange.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/linetest.cxx
+--- basebmp/test/linetest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/linetest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/point/b2ipoint.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/makefile.mk
+--- basebmp/test/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -60,6 +60,13 @@
+ .ENDIF
+ .ENDIF
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ 
+ # --- Common ----------------------------------------------------------
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/masktest.cxx
+--- basebmp/test/masktest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/masktest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/range/b2irange.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basebmp/test/polytest.cxx
+--- basebmp/test/polytest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basebmp/test/polytest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,9 +27,11 @@
+ 
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/vector/b2isize.hxx>
+ #include <basegfx/range/b2irange.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/basegfx1d.cxx
+--- basegfx/test/basegfx1d.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/basegfx1d.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,10 +30,12 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
+ #include "cppunit/plugin/TestPlugIn.h"
++#include "postextstl.h"
+ 
+ namespace basegfx1d
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/basegfx2d.cxx
+--- basegfx/test/basegfx2d.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/basegfx2d.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,9 +30,11 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/matrix/b2dhommatrix.hxx>
+ #include <basegfx/polygon/b2dpolygon.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/basegfx3d.cxx
+--- basegfx/test/basegfx3d.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/basegfx3d.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,9 +30,11 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ namespace basegfx3d
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/basegfxtools.cxx
+--- basegfx/test/basegfxtools.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/basegfxtools.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,9 +30,11 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/tools/keystoplerp.hxx>
+ #include <basegfx/numeric/ftools.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/boxclipper.cxx
+--- basegfx/test/boxclipper.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/boxclipper.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,9 +30,11 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/matrix/b2dhommatrix.hxx>
+ #include <basegfx/curve/b2dcubicbezier.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/clipstate.cxx
+--- basegfx/test/clipstate.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/clipstate.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,9 +30,11 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/tools/b2dclipstate.hxx>
+ #include <basegfx/range/b2dpolyrange.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/genericclipper.cxx
+--- basegfx/test/genericclipper.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/genericclipper.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -30,9 +30,11 @@
+ #include "precompiled_basegfx.hxx"
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <basegfx/matrix/b2dhommatrix.hxx>
+ #include <basegfx/curve/b2dcubicbezier.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 basegfx/test/makefile.mk
+--- basegfx/test/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ basegfx/test/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -36,6 +36,13 @@
+ 
+ .INCLUDE :  settings.mk
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ 
+ # --- Common ----------------------------------------------------------
+diff -r a1a3b75faa8a -r a6913c9677c2 configure.in
+--- configure.in	Fri Jul 30 12:58:40 2010 +0100
++++ configure.in	Tue Aug 03 10:01:07 2010 +0100
+@@ -3821,12 +3821,6 @@
+     SYSTEM_CPPUNIT=YES
+     # might work for earlier, too but go sure
+     PKG_CHECK_MODULES( CPPUNIT, cppunit >= 1.12.0 )
+-    AC_MSG_CHECKING([STL compatibility])
+-    if test "$WITH_STLPORT" != "no"; then
+-	AC_MSG_ERROR([to use system cppunit you need to use --without-stlport])
+-    else
+-	AC_MSG_RESULT([OK])	
+-    fi
+ else
+     AC_MSG_RESULT([internal])
+     SYSTEM_CPPUNIT=NO
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_connection.cxx
+--- mysqlc/source/mysqlc_connection.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_connection.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -35,13 +35,13 @@
+ #include "mysqlc_preparedstatement.hxx"
+ #include "mysqlc_general.hxx"
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/driver.h>
+ #include <cppconn/connection.h>
+ #include <cppconn/statement.h>
+ #include <cppconn/metadata.h>
+ #include <cppconn/exception.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ #include <com/sun/star/sdbc/ColumnValue.hpp>
+ #include <com/sun/star/sdbc/XRow.hpp>
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_connection.hxx
+--- mysqlc/source/mysqlc_connection.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_connection.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -46,9 +46,9 @@
+ #include <com/sun/star/sdbc/XWarningsSupplier.hpp>
+ #include <com/sun/star/util/XStringSubstitution.hpp>
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/driver.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ #include <cppuhelper/compbase3.hxx>
+ #include <cppuhelper/weakref.hxx>
+ #include <rtl/string.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_databasemetadata.cxx
+--- mysqlc/source/mysqlc_databasemetadata.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_databasemetadata.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -54,13 +54,13 @@
+ using ::rtl::OUString;
+ using mysqlc_sdbc_driver::getStringFromAny;
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/connection.h>
+ #include <cppconn/resultset.h>
+ #include <cppconn/metadata.h>
+ #include <cppconn/statement.h>
+ #include <cppconn/prepared_statement.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ static ext_std::string wild("%");
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_databasemetadata.hxx
+--- mysqlc/source/mysqlc_databasemetadata.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_databasemetadata.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -39,9 +39,9 @@
+ #include <cppuhelper/implbase1.hxx>
+ #endif
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/metadata.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ namespace connectivity
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_driver.cxx
+--- mysqlc/source/mysqlc_driver.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_driver.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -38,13 +38,12 @@
+ using ::rtl::OUString;
+ #include <stdio.h>
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/exception.h>
+-
+ #ifdef SYSTEM_MYSQL_CPPCONN
+     #include <mysql_driver.h>
+ #endif
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ 
+ /* {{{ MysqlCDriver::MysqlCDriver() -I- */
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_driver.hxx
+--- mysqlc/source/mysqlc_driver.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_driver.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -36,9 +36,9 @@
+ #include <com/sun/star/lang/XServiceInfo.hpp>
+ 
+ #include <cppuhelper/compbase2.hxx>
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/driver.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ #include <osl/module.h>
+ 
+ namespace connectivity
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_general.hxx
+--- mysqlc/source/mysqlc_general.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_general.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -33,9 +33,9 @@
+ #include <com/sun/star/uno/XInterface.hpp>
+ #include <com/sun/star/sdbc/SQLException.hpp>
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/exception.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ namespace mysqlc_sdbc_driver
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_preparedstatement.hxx
+--- mysqlc/source/mysqlc_preparedstatement.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_preparedstatement.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -48,9 +48,9 @@
+ #include <com/sun/star/io/XInputStream.hpp>
+ #endif
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/prepared_statement.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ namespace connectivity
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_resultsetmetadata.hxx
+--- mysqlc/source/mysqlc_resultsetmetadata.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_resultsetmetadata.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -35,9 +35,9 @@
+ #include <com/sun/star/sdbc/XResultSetMetaData.hpp>
+ 
+ #include <cppuhelper/implbase1.hxx>
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/resultset_metadata.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ namespace connectivity
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 mysqlc/source/mysqlc_statement.hxx
+--- mysqlc/source/mysqlc_statement.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ mysqlc/source/mysqlc_statement.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -13,9 +13,9 @@
+ #include <com/sun/star/sdbc/XWarningsSupplier.hpp>
+ #include <com/sun/star/util/XCancellable.hpp>
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <cppconn/statement.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ #include <cppuhelper/compbase5.hxx>
+ #include <list>
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 o3tl/qa/makefile.mk
+--- o3tl/qa/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ o3tl/qa/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -36,6 +36,13 @@
+ 
+ .INCLUDE :  settings.mk
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ 
+ .IF "$(L10N_framework)"==""
+diff -r a1a3b75faa8a -r a6913c9677c2 o3tl/qa/test-cow_wrapper.cxx
+--- o3tl/qa/test-cow_wrapper.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ o3tl/qa/test-cow_wrapper.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -1,9 +1,11 @@
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
+ #include "cppunit/plugin/TestPlugIn.h"
++#include "postextstl.h"
+ 
+ #include "cow_wrapper_clients.hxx"
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 o3tl/qa/test-heap_ptr.cxx
+--- o3tl/qa/test-heap_ptr.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ o3tl/qa/test-heap_ptr.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -25,9 +25,11 @@
+  *
+  ************************************************************************/
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <o3tl/heap_ptr.hxx>
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 o3tl/qa/test-range.cxx
+--- o3tl/qa/test-range.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ o3tl/qa/test-range.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -25,9 +25,11 @@
+  *
+  ************************************************************************/
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <o3tl/range.hxx>
+ #include <vector>
+diff -r a1a3b75faa8a -r a6913c9677c2 o3tl/qa/test-vector_pool.cxx
+--- o3tl/qa/test-vector_pool.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ o3tl/qa/test-vector_pool.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -1,8 +1,10 @@
+ // autogenerated file with codegen.pl
+ 
++#include "preextstl.h"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
++#include "postextstl.h"
+ 
+ #include <o3tl/vector_pool.hxx>
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 sal/cppunittester/cppunittester.cxx
+--- sal/cppunittester/cppunittester.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ sal/cppunittester/cppunittester.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -31,6 +31,7 @@
+ #include <cstdlib>
+ #include <iostream>
+ 
++#include "preextstl.h"
+ #include "cppunit/CompilerOutputter.h"
+ #include "cppunit/TestResult.h"
+ #include "cppunit/TestResultCollector.h"
+@@ -38,6 +39,7 @@
+ #include "cppunit/extensions/TestFactoryRegistry.h"
+ #include "cppunit/plugin/PlugInManager.h"
+ #include "cppunit/portability/Stream.h"
++#include "postextstl.h"
+ #include "osl/thread.h"
+ #include "rtl/process.h"
+ #include "rtl/string.hxx"
+diff -r a1a3b75faa8a -r a6913c9677c2 sal/cppunittester/makefile.mk
+--- sal/cppunittester/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ sal/cppunittester/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -33,6 +33,13 @@
+ 
+ .INCLUDE: settings.mk
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ 
+ OBJFILES = $(APP1OBJS)
+diff -r a1a3b75faa8a -r a6913c9677c2 sax/qa/cppunit/makefile.mk
+--- sax/qa/cppunit/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ sax/qa/cppunit/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -35,6 +35,13 @@
+ 
+ .INCLUDE :  settings.mk
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ DLLPRE = # no leading "lib" on .so files
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 sax/qa/cppunit/test_converter.cxx
+--- sax/qa/cppunit/test_converter.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ sax/qa/cppunit/test_converter.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -25,10 +25,12 @@
+  *
+  ************************************************************************/
+ 
++#include "preextstl.h"
+ #include <cppunit/TestAssert.h>
+ #include <cppunit/TestFixture.h>
+ #include <cppunit/extensions/HelperMacros.h>
+ #include <cppunit/plugin/TestPlugIn.h>
++#include "postextstl.h"
+ 
+ #include <rtl/ustrbuf.hxx>
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 sfx2/qa/cppunit/makefile.mk
+--- sfx2/qa/cppunit/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ sfx2/qa/cppunit/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -35,6 +35,13 @@
+ 
+ .INCLUDE :  settings.mk
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ DLLPRE = # no leading "lib" on .so files
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 sfx2/qa/cppunit/test_metadatable.cxx
+--- sfx2/qa/cppunit/test_metadatable.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ sfx2/qa/cppunit/test_metadatable.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -27,10 +27,12 @@
+ 
+ #include "precompiled_sfx2.hxx"
+ 
++#include "preextstl.h"
+ #include <cppunit/TestAssert.h>
+ #include <cppunit/TestFixture.h>
+ #include <cppunit/extensions/HelperMacros.h>
+ #include <cppunit/plugin/TestPlugIn.h>
++#include "postextstl.h"
+ 
+ #include <rtl/ustrbuf.hxx>
+ 
+diff -r a1a3b75faa8a -r a6913c9677c2 smoketestoo_native/makefile.mk
+--- smoketestoo_native/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ smoketestoo_native/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -33,6 +33,13 @@
+ 
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ SLOFILES = $(SHL1OBJS)
+ 
+ SHL1TARGET = smoketest
+diff -r a1a3b75faa8a -r a6913c9677c2 smoketestoo_native/smoketest.cxx
+--- smoketestoo_native/smoketest.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ smoketestoo_native/smoketest.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -44,11 +44,13 @@
+ #include "com/sun/star/uno/RuntimeException.hpp"
+ #include "com/sun/star/uno/Sequence.hxx"
+ #include "com/sun/star/util/URL.hpp"
++#include <preextstl.h>
+ #include "cppuhelper/implbase1.hxx"
+ #include "cppunit/TestAssert.h"
+ #include "cppunit/TestFixture.h"
+ #include "cppunit/extensions/HelperMacros.h"
+ #include "cppunit/plugin/TestPlugIn.h"
++#include <postextstl.h>
+ #include "osl/conditn.hxx"
+ #include "osl/diagnose.h"
+ #include "rtl/ustring.h"
+diff -r a1a3b75faa8a -r a6913c9677c2 stlport/prj/d.lst
+--- stlport/prj/d.lst	Fri Jul 30 12:58:40 2010 +0100
++++ stlport/prj/d.lst	Tue Aug 03 10:01:07 2010 +0100
+@@ -17,6 +17,7 @@
+ ..\%__SRC%\inc\stlport\using\h\* %_DEST%\inc%_EXT%\stl\using\h\*
+ ..\%__SRC%\inc\stlport\wrap_std\* %_DEST%\inc%_EXT%\stl\wrap_std\*
+ ..\%__SRC%\inc\stlport\wrap_std\h\* %_DEST%\inc%_EXT%\stl\wrap_std\h\*
++..\systemstlguards\*.h %_DEST%\inc%_EXT%\stl\*.h
+ ..\%__SRC%\lib\lib*.so %_DEST%\lib%_EXT%\lib*.so
+ ..\%__SRC%\lib\lib*.a %_DEST%\lib%_EXT%\lib*.a
+ ..\%__SRC%\lib\*.lib %_DEST%\lib%_EXT%\*.lib
+diff -r a1a3b75faa8a -r a6913c9677c2 stlport/systemstlguards/postextstl.h
+--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
++++ stlport/systemstlguards/postextstl.h	Tue Aug 03 10:01:07 2010 +0100
+@@ -0,0 +1,36 @@
++/*************************************************************************
++ *
++ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
++ * 
++ * Copyright 2000, 2010 Oracle and/or its affiliates.
++ *
++ * OpenOffice.org - a multi-platform office productivity suite
++ *
++ * This file is part of OpenOffice.org.
++ *
++ * OpenOffice.org is free software: you can redistribute it and/or modify
++ * it under the terms of the GNU Lesser General Public License version 3
++ * only, as published by the Free Software Foundation.
++ *
++ * OpenOffice.org is distributed in the hope that it will be useful,
++ * but WITHOUT ANY WARRANTY; without even the implied warranty of
++ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
++ * GNU Lesser General Public License version 3 for more details
++ * (a copy is included in the LICENSE file that accompanied this code).
++ *
++ * You should have received a copy of the GNU Lesser General Public License
++ * version 3 along with OpenOffice.org.  If not, see
++ * <http://www.openoffice.org/license.html>
++ * for a copy of the LGPLv3 License.
++ *
++ ************************************************************************/
++
++#ifdef std_was_redefined_as_stlport
++//  put things back the way they were
++#   define std std_was_redefined_as_stlport
++#   undef _STLP_OUTERMOST_HEADER_ID
++//  force config to be re-read
++#   undef _STLP_NOTHROW_INHERENTLY
++#   undef _STLP_CONFIG_H
++#   include <stddef.h>
++#endif
+diff -r a1a3b75faa8a -r a6913c9677c2 stlport/systemstlguards/preextstl.h
+--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
++++ stlport/systemstlguards/preextstl.h	Tue Aug 03 10:01:07 2010 +0100
+@@ -0,0 +1,77 @@
++/*************************************************************************
++ *
++ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
++ * 
++ * Copyright 2000, 2010 Oracle and/or its affiliates.
++ *
++ * OpenOffice.org - a multi-platform office productivity suite
++ *
++ * This file is part of OpenOffice.org.
++ *
++ * OpenOffice.org is free software: you can redistribute it and/or modify
++ * it under the terms of the GNU Lesser General Public License version 3
++ * only, as published by the Free Software Foundation.
++ *
++ * OpenOffice.org is distributed in the hope that it will be useful,
++ * but WITHOUT ANY WARRANTY; without even the implied warranty of
++ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
++ * GNU Lesser General Public License version 3 for more details
++ * (a copy is included in the LICENSE file that accompanied this code).
++ *
++ * You should have received a copy of the GNU Lesser General Public License
++ * version 3 along with OpenOffice.org.  If not, see
++ * <http://www.openoffice.org/license.html>
++ * for a copy of the LGPLv3 License.
++ *
++ ************************************************************************/
++//1. Force inclusion of a std:: using header to ensure the stlport define
++//of std as "stlport"
++#include <algorithm>
++#if defined(ADAPT_EXT_STL)
++//2. Force inclusion of stlport headers to get their stlport:: definitions
++#   include <ostream>
++#   include <istream>
++#   include <fstream>
++#   include <iostream>
++#   include <sstream>
++#   include <vector>
++#   include <deque>
++#   include <set>
++#   include <list>
++#   include <map>
++//3. Now force inclusion of native headers to get their std:: definitions
++#   if defined(std)
++#       define std_was_redefined_as_stlport std
++#       undef std
++#       define _STLP_OUTERMOST_HEADER_ID 0xdeadbeaf
++#       if defined(_GNUC__)
++#           pragma GCC visibility push(default)
++#       endif
++#       include _STLP_NATIVE_HEADER(exception_defines.h)
++#       include _STLP_NATIVE_HEADER(limits)
++#       include _STLP_NATIVE_HEADER(memory)
++#       include _STLP_NATIVE_HEADER(exception)
++#       include _STLP_NATIVE_HEADER(iosfwd)
++#       include _STLP_NATIVE_HEADER(algorithm)
++#       include _STLP_NATIVE_HEADER(string)
++#       include _STLP_NATIVE_HEADER(streambuf)
++#       include _STLP_NATIVE_HEADER(ios)
++#       include _STLP_NATIVE_HEADER(locale)
++#       include _STLP_NATIVE_HEADER(stdexcept)
++#       include _STLP_NATIVE_HEADER(ostream)
++#       include _STLP_NATIVE_HEADER(istream)
++#       include _STLP_NATIVE_HEADER(iostream)
++#       include _STLP_NATIVE_HEADER(sstream)
++#       include _STLP_NATIVE_HEADER(vector)
++#       include _STLP_NATIVE_HEADER(deque)
++#       include _STLP_NATIVE_HEADER(set)
++#       include _STLP_NATIVE_HEADER(list)
++#       include _STLP_NATIVE_HEADER(map)
++#       if defined(_GNUC__)
++#           pragma GCC visibility pop
++#       endif
++#   endif
++#endif
++//ext_std resolves to the std that external c++ libs, e.g. Graphite were built
++//against regardless of whether that is stlport or system stl
++namespace ext_std = std;
+diff -r a1a3b75faa8a -r a6913c9677c2 test/source/cpp/makefile.mk
+--- test/source/cpp/makefile.mk	Fri Jul 30 12:58:40 2010 +0100
++++ test/source/cpp/makefile.mk	Tue Aug 03 10:01:07 2010 +0100
+@@ -35,6 +35,13 @@
+ CDEFS += -DOOO_DLLIMPLEMENTATION_TEST
+ CFLAGSCXX += $(CPPUNIT_CFLAGS)
+ 
++#building with stlport, but cppunit was not built with stlport
++.IF "$(USE_SYSTEM_STL)"!="YES"
++.IF "$(SYSTEM_CPPUNIT)"=="YES"
++CFLAGSCXX+=-DADAPT_EXT_STL
++.ENDIF
++.ENDIF
++
+ SLOFILES = \
+     $(SLO)/getargument.obj \
+     $(SLO)/officeconnection.obj \
+diff -r a1a3b75faa8a -r a6913c9677c2 test/source/cpp/officeconnection.cxx
+--- test/source/cpp/officeconnection.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ test/source/cpp/officeconnection.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -33,7 +33,9 @@
+ #include "com/sun/star/lang/XMultiServiceFactory.hpp"
+ #include "com/sun/star/uno/Reference.hxx"
+ #include "cppuhelper/bootstrap.hxx"
++#include <preextstl.h>
+ #include "cppunit/TestAssert.h"
++#include <postextstl.h>
+ #include "osl/process.h"
+ #include "osl/time.h"
+ #include "sal/types.h"
+diff -r a1a3b75faa8a -r a6913c9677c2 tools/inc/tools/postextstl.h
+--- tools/inc/tools/postextstl.h	Fri Jul 30 12:58:40 2010 +0100
++++ /dev/null	Thu Jan 01 00:00:00 1970 +0000
+@@ -1,36 +0,0 @@
+-/*************************************************************************
+- *
+- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+- * 
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
+- *
+- * OpenOffice.org - a multi-platform office productivity suite
+- *
+- * This file is part of OpenOffice.org.
+- *
+- * OpenOffice.org is free software: you can redistribute it and/or modify
+- * it under the terms of the GNU Lesser General Public License version 3
+- * only, as published by the Free Software Foundation.
+- *
+- * OpenOffice.org is distributed in the hope that it will be useful,
+- * but WITHOUT ANY WARRANTY; without even the implied warranty of
+- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+- * GNU Lesser General Public License version 3 for more details
+- * (a copy is included in the LICENSE file that accompanied this code).
+- *
+- * You should have received a copy of the GNU Lesser General Public License
+- * version 3 along with OpenOffice.org.  If not, see
+- * <http://www.openoffice.org/license.html>
+- * for a copy of the LGPLv3 License.
+- *
+- ************************************************************************/
+-
+-#ifdef std_was_redefined_as_stlport
+-//  put things back the way they were
+-#   define std std_was_redefined_as_stlport
+-#   undef _STLP_OUTERMOST_HEADER_ID
+-//  force config to be re-read
+-#   undef _STLP_NOTHROW_INHERENTLY
+-#   undef _STLP_CONFIG_H
+-#   include <stddef.h>
+-#endif
+diff -r a1a3b75faa8a -r a6913c9677c2 tools/inc/tools/preextstl.h
+--- tools/inc/tools/preextstl.h	Fri Jul 30 12:58:40 2010 +0100
++++ /dev/null	Thu Jan 01 00:00:00 1970 +0000
+@@ -1,71 +0,0 @@
+-/*************************************************************************
+- *
+- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
+- * 
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
+- *
+- * OpenOffice.org - a multi-platform office productivity suite
+- *
+- * This file is part of OpenOffice.org.
+- *
+- * OpenOffice.org is free software: you can redistribute it and/or modify
+- * it under the terms of the GNU Lesser General Public License version 3
+- * only, as published by the Free Software Foundation.
+- *
+- * OpenOffice.org is distributed in the hope that it will be useful,
+- * but WITHOUT ANY WARRANTY; without even the implied warranty of
+- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+- * GNU Lesser General Public License version 3 for more details
+- * (a copy is included in the LICENSE file that accompanied this code).
+- *
+- * You should have received a copy of the GNU Lesser General Public License
+- * version 3 along with OpenOffice.org.  If not, see
+- * <http://www.openoffice.org/license.html>
+- * for a copy of the LGPLv3 License.
+- *
+- ************************************************************************/
+-//1. Force inclusion of a std:: using header to ensure the stlport define
+-//of std as "stlport"
+-#include <algorithm>
+-#if defined(ADAPT_EXT_STL)
+-//2. Force inclusion of stlport headers to get their stlport:: definitions
+-#   include <ostream>
+-#   include <istream>
+-#   include <fstream>
+-#   include <iostream>
+-#   include <vector>
+-#   include <list>
+-#   include <map>
+-//3. Now force inclusion of native headers to get their std:: definitions
+-#   if defined(std)
+-#       define std_was_redefined_as_stlport std
+-#       undef std
+-#       define _STLP_OUTERMOST_HEADER_ID 0xdeadbeaf
+-#       if defined(_GNUC__)
+-#           pragma GCC visibility push(default)
+-#       endif
+-#       include _STLP_NATIVE_HEADER(exception_defines.h)
+-#       include _STLP_NATIVE_HEADER(limits)
+-#       include _STLP_NATIVE_HEADER(memory)
+-#       include _STLP_NATIVE_HEADER(exception)
+-#       include _STLP_NATIVE_HEADER(iosfwd)
+-#       include _STLP_NATIVE_HEADER(algorithm)
+-#       include _STLP_NATIVE_HEADER(string)
+-#       include _STLP_NATIVE_HEADER(streambuf)
+-#       include _STLP_NATIVE_HEADER(ios)
+-#       include _STLP_NATIVE_HEADER(locale)
+-#       include _STLP_NATIVE_HEADER(stdexcept)
+-#       include _STLP_NATIVE_HEADER(ostream)
+-#       include _STLP_NATIVE_HEADER(istream)
+-#       include _STLP_NATIVE_HEADER(iostream)
+-#       include _STLP_NATIVE_HEADER(vector)
+-#       include _STLP_NATIVE_HEADER(list)
+-#       include _STLP_NATIVE_HEADER(map)
+-#       if defined(_GNUC__)
+-#           pragma GCC visibility pop
+-#       endif
+-#   endif
+-#endif
+-//ext_std resolves to the std that external c++ libs, e.g. Graphite were built
+-//against regardless of whether that is stlport or system stl
+-namespace ext_std = std;
+diff -r a1a3b75faa8a -r a6913c9677c2 tools/prj/d.lst
+--- tools/prj/d.lst	Fri Jul 30 12:58:40 2010 +0100
++++ tools/prj/d.lst	Tue Aug 03 10:01:07 2010 +0100
+@@ -34,9 +34,6 @@
+ ..\inc\tools\postx.h %_DEST%\inc%_EXT%\tools\postx.h
+ ..\inc\tools\prex.h %_DEST%\inc%_EXT%\tools\prex.h
+ 
+-..\inc\tools\postextstl.h %_DEST%\inc%_EXT%\tools\postextstl.h
+-..\inc\tools\preextstl.h %_DEST%\inc%_EXT%\tools\preextstl.h
+-
+ ..\inc\tools\svlibrary.hxx %_DEST%\inc%_EXT%\tools\svlibrary.hxx
+ ..\inc\tools\solarmutex.hxx %_DEST%\inc%_EXT%\tools\solarmutex.hxx
+ ..\inc\tools\wintypes.hxx %_DEST%\inc%_EXT%\tools\wintypes.hxx
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/inc/vcl/graphite_adaptors.hxx
+--- vcl/inc/vcl/graphite_adaptors.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/inc/vcl/graphite_adaptors.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -55,11 +55,11 @@
+ #include "vcl/dllapi.h"
+ 
+ // Libraries
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <graphite/GrClient.h>
+ #include <graphite/Font.h>
+ #include <graphite/ITextSource.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ // Module type definitions and forward declarations.
+ //
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/inc/vcl/graphite_features.hxx
+--- vcl/inc/vcl/graphite_features.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/inc/vcl/graphite_features.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -29,11 +29,11 @@
+ // Parse a string of features specified as ; separated pairs.
+ // e.g.
+ // 1001=1&2002=2&fav1=0
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <graphite/GrClient.h>
+ #include <graphite/Font.h>
+ #include <graphite/GrFeature.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ namespace grutils
+ {
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/inc/vcl/graphite_layout.hxx
+--- vcl/inc/vcl/graphite_layout.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/inc/vcl/graphite_layout.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -40,13 +40,13 @@
+ #include <vector>
+ #include <utility>
+ // Libraries
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <graphite/GrClient.h>
+ #include <graphite/Font.h>
+ #include <graphite/GrConstants.h>
+ #include <graphite/GrAppData.h>
+ #include <graphite/SegmentAux.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ // Platform
+ #include <vcl/sallayout.hxx>
+ #include <vcl/dllapi.h>
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/source/glyphs/graphite_cache.cxx
+--- vcl/source/glyphs/graphite_cache.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/source/glyphs/graphite_cache.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -36,10 +36,10 @@
+ #include <tools/debug.hxx>
+ #include <vcl/sallayout.hxx>
+ 
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <graphite/GrClient.h>
+ #include <graphite/Segment.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ #include <rtl/ustring.hxx>
+ #include <vcl/graphite_layout.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/source/glyphs/graphite_layout.cxx
+--- vcl/source/glyphs/graphite_layout.cxx	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/source/glyphs/graphite_layout.cxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -63,13 +63,13 @@
+ #include <unicode/uscript.h>
+ 
+ // Graphite Libraries (must be after vcl headers on windows)
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <graphite/GrClient.h>
+ #include <graphite/Font.h>
+ #include <graphite/ITextSource.h>
+ #include <graphite/Segment.h>
+ #include <graphite/SegmentPainter.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ #include <vcl/graphite_layout.hxx>
+ #include <vcl/graphite_features.hxx>
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/source/glyphs/graphite_textsrc.hxx
+--- vcl/source/glyphs/graphite_textsrc.hxx	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/source/glyphs/graphite_textsrc.hxx	Tue Aug 03 10:01:07 2010 +0100
+@@ -59,11 +59,11 @@
+ #include "vcl/dllapi.h"
+ 
+ // Libraries
+-#include <tools/preextstl.h>
++#include <preextstl.h>
+ #include <graphite/GrClient.h>
+ #include <graphite/Font.h>
+ #include <graphite/ITextSource.h>
+-#include <tools/postextstl.h>
++#include <postextstl.h>
+ 
+ // Module type definitions and forward declarations.
+ //
+diff -r a1a3b75faa8a -r a6913c9677c2 vcl/util/makefile2.pmk
+--- vcl/util/makefile2.pmk	Fri Jul 30 12:58:40 2010 +0100
++++ vcl/util/makefile2.pmk	Tue Aug 03 10:01:07 2010 +0100
+@@ -36,6 +36,6 @@
+ #building with stlport, but graphite was not built with stlport
+ .IF "$(USE_SYSTEM_STL)"!="YES"
+ .IF "$(SYSTEM_GRAPHITE)"=="YES"
+-CDEFS += -DADAPT_EXT_STL
++CFLAGSCXX+=-DADAPT_EXT_STL
+ .ENDIF
+ .ENDIF
+
