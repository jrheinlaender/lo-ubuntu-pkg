Index: libreoffice-3.4.1/libreoffice-build/patches/dev300/debian-opt.diff
===================================================================
--- libreoffice-3.4.1.orig/libreoffice-build/patches/dev300/debian-opt.diff	2011-07-06 16:59:46.365044255 +0200
+++ libreoffice-3.4.1/libreoffice-build/patches/dev300/debian-opt.diff	2011-07-06 17:00:02.465044476 +0200
@@ -1,37 +1,103 @@
-Index: unxlngs.mk
-===================================================================
---- solenv/inc/unxlngs.mk	(Revision 276754)
-+++ solenv/inc/unxlngs.mk	(Arbeitskopie)
-@@ -33,7 +33,7 @@
+diff --git a/configure.in b/configure.in
+index c0b76f8..d10222f 100644
+--- configure.in
++++ configure.in
+@@ -7936,6 +7936,13 @@ fi
+ AC_MSG_RESULT([$BUILD_MAX_JOBS])
+ AC_SUBST(BUILD_MAX_JOBS)
  
- ASM=$(CC)
- AFLAGS=-Wa,-K,PIC -c $(CDEFS)
--CDEFAULTOPT=-Os
-+CDEFAULTOPT=-O2
- PICSWITCH:=-fPIC
- .INCLUDE : unxlng.mk
- CDEFS+=-DSPARC
-Index: unxlngi.mk
-===================================================================
---- solenv/inc/unxlngi.mk	(Revision 276754)
-+++ solenv/inc/unxlngi.mk	(Arbeitskopie)
-@@ -30,7 +30,7 @@
++if [ -x /usr/bin/dpkg-buildflags ]; then
++	CDEFAULTOPT=`dpkg-buildflags --get CFLAGS 2>/dev/null | grep -E -o "\-O[0-3]"`
++else
++	CDEFAULTOPT=-O2
++fi
++AC_SUBST(CDEFAULTOPT)
++
+ dnl ===================================================================
+ dnl Setting up the environment.
+ dnl ===================================================================
+diff --git a/set_soenv.in b/set_soenv.in
+index ea9f10c..1b32f7f 100644
+--- set_soenv.in
++++ set_soenv.in
+@@ -1748,6 +1748,7 @@ ToFile( "COMPATH",           $COMPATH,           "e" );
+ ToFile( "CPU",               $CPU,               "e" );
+ ToFile( "CPUNAME",           $CPUNAME,           "e" );
+ ToFile( "CVER",              $CVER,              "e" );
++ToFile( "CDEFAULTOPT",       "@CDEFAULTOPT@",    "e" );
+ ToFile( "GUI",               $GUI,               "e" );
+ ToFile( "GLIBC",             $GLIBC,             "e" );
+ ToFile( "GUIBASE",           $GUIBASE,           "e" );
+diff --git a/solenv/inc/unxgcc.mk b/solenv/inc/unxgcc.mk
+index b54736c..4f7177d 100644
+--- solenv/inc/unxgcc.mk
++++ solenv/inc/unxgcc.mk
+@@ -31,7 +31,7 @@ ASM*=
+ AFLAGS*=
+ SOLAR_JAVA*=
+ # default optimization level for product code
+-CDEFAULTOPT*=-O2
++CDEFAULTOPT*=$(shell dpkg-buildflags --get CFLAGS 2>/dev/null | $(GREP) -E -o "\-O[0-3]" || echo "-O2")
+ # architecture dependent flags for the C and C++ compiler that can be changed by
+ # exporting the variable ARCH_FLAGS="..." in the shell, which is used to start build
+ ARCH_FLAGS*=
+diff --git a/solenv/inc/unxlngi.mk b/solenv/inc/unxlngi.mk
+index d86aab1..a10adb6 100644
+--- solenv/inc/unxlngi.mk
++++ solenv/inc/unxlngi.mk
+@@ -26,7 +26,6 @@
  #*************************************************************************
  
  # mk file for Unix Linux Intel (X86) using GCC, please make generic modifications to unxlng.mk
 -CDEFAULTOPT=-Os
-+CDEFAULTOPT=-O2
  .IF "$(GCCNUMVER)" >= "000400050000"
  ARCH_FLAGS*=-mtune=atom
  .ELSE
---- solenv/inc/unxlngppc.mk	(Revision 277719)
-+++ solenv/inc/unxlngppc.mk	(Arbeitskopie)
-@@ -31,7 +31,7 @@
+diff --git a/solenv/inc/unxlngm68k.mk b/solenv/inc/unxlngm68k.mk
+index da6ed55..284bfa8 100644
+--- solenv/inc/unxlngm68k.mk
++++ solenv/inc/unxlngm68k.mk
+@@ -27,7 +27,6 @@
+ 
+ # mk file for Unix Linux m68k using GCC, please make generic modifications to unxlng.mk
+ 
+-CDEFAULTOPT=-Os
+ PICSWITCH:=-fPIC
+ .INCLUDE : unxlng.mk
+ CDEFS+=-DM68K
+diff --git a/solenv/inc/unxlngmips.mk b/solenv/inc/unxlngmips.mk
+index 53c927d..c1b7164 100644
+--- solenv/inc/unxlngmips.mk
++++ solenv/inc/unxlngmips.mk
+@@ -27,7 +27,6 @@
  
- # mk file for Unix Linux PowerPC using GCC, please make generic modifications to unxlng.mk
+ # mk file for Unix Linux Mips using GCC, please make generic modifications to unxlng.mk
  
--DEFAULTOPT=-Os
-+DEFAULTOPT=-O2
+-CDEFAULTOPT=-Os
+ .INCLUDE : unxlng.mk
+ CDEFS+=-DMIPS
+ DLLPOSTFIX=lm
+diff --git a/solenv/inc/unxlngr.mk b/solenv/inc/unxlngr.mk
+index 1bcbb66..acd84fb 100644
+--- solenv/inc/unxlngr.mk
++++ solenv/inc/unxlngr.mk
+@@ -27,7 +27,6 @@
+ 
+ # mk file for Unix Linux ARM using GCC, please make generic modifications to unxlng.mk
+ 
+-CDEFAULTOPT=-Os
+ .INCLUDE : unxlng.mk
+ CDEFS+=-DARM32
+ CFLAGS+=-fno-omit-frame-pointer
+diff --git a/solenv/inc/unxlngs.mk b/solenv/inc/unxlngs.mk
+index b4e6f5f..f33411a 100644
+--- solenv/inc/unxlngs.mk
++++ solenv/inc/unxlngs.mk
+@@ -29,7 +29,6 @@
+ 
+ ASM=$(CC)
+ AFLAGS=-Wa,-K,PIC -c $(CDEFS)
+-CDEFAULTOPT=-Os
  PICSWITCH:=-fPIC
  .INCLUDE : unxlng.mk
- CDEFS+=-DPOWERPC -DPPC
+ CDEFS+=-DSPARC
