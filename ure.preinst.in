#!/bin/sh

set -e

. /usr/share/debconf/confmodule

if [ "$1" = "upgrade" ]; then
	if dpkg --compare-versions $2 ge 1.5.0+OOo3.1.0-2 && \
	   dpkg --compare-versions $2 le 1.5.1+OOo3.1.1-14; then
		if [ "$DEBIAN_FRONTEND" = "noninteractive" ]; then
			echo "Component registries might be corrupted" >&2
			echo "" >&2
			echo "You are upgrading from a version which might have corrupted service/component" >&2
 			echo "registry files (*.rdb)." >&2
			echo "" >&2
 			echo "Especially /var/lib/openoffice/basis3.1/program/services.rdb and the" >&2
 			echo "rdbs below /var/spool/openoffice/uno_packages/cache for installed extensions." >&2
			echo "" >&2
			echo "If you experience problems with the component manager or segmentation faults" >&2
			echo "in either unopkg or OOo which involve store, please check those" >&2
			echo "(and eventually cleanly reinstall the packages and/or use a clean user profile)" >&2
		else
			db_input high ure/possibly_corrupted_rdbs
			db_go || true
		fi
	fi
fi

#DEBHELPER#

exit 0

